<apex:page sidebar="false" standardStylesheets="true" showHeader="false" docType="html-5.0"
           standardcontroller="Opportunity" extensions="GeneralInformationController" 
           action="{!init}"> 
    <head> 

        <apex:includeScript value="https://ajax.googleapis.com/ajax/libs/jquery/1.12.1/jquery.min.js"/>
        <apex:includeScript value="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"/>

        <apex:includeScript value="{!URLFOR($Resource.bootstrap3, 'js/bootstrap.min.js')}"/>
        <apex:includeScript value="{!URLFOR($Resource.bootstrapExtra, 'bootstrap-3.3.1/js/tab.js')}"/>
        <apex:includeScript value="{!URLFOR($Resource.datepicker, 'datepicker/js/bootstrap-datepicker.js')}"/> 
        <apex:includeScript value="{!URLFOR($Resource.jQueryNumeric, 'js/jquery.numeric.min.js')}"/>

        <apex:stylesheet value="{!URLFOR($Resource.bootstrap, 'bootstrap/css/bootstrap.css')}"/>
        <apex:stylesheet value="{!URLFOR($Resource.bootstrap, 'bootstrap/css/bootstrap.min.css')}"/>
        <apex:stylesheet value="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/base/jquery-ui.css"/>

        <!--------------- Include StyleSheet -------------------------- -->     
        <apex:include pageName="SetupFormsStyleSheet"/>
        
        
        
        <style>
            .nav
            {
                margin-bottom:0px
            }
            
            #enrollmentRushWarningMsgContainer {
                background-color: yellow;
                font-size: 1rem;
                margin: 0.5rem 0.25rem;
            }
            
            .af-afenroll-payroll-group {
                font-weight: bold;
            }
            
            .af-enrollmentPathContainer {
                display: inline-block;
                margin: 1rem 1rem;
                max-width: 200px;
                vertical-align: top;
                border: 1px solid rgb(204, 204, 204);
                border-radius: 10px;
                position: relative;
                box-shadow: 5px 5px 7px 5px #979596;
            }
            
            .af-enrollmentPathTitle {
                background-color: #175fb2;
                color: white;
                font-size: 1.25rem;
                line-height: normal;
                text-align: center;
                padding: 0.25rem;
                border-radius: 6px 6px 0px 0px;
            }
            
            .af-enrollmentPathBody {
                padding: 0.5rem;
                margin-bottom: 20px;
            }
            
            .af-enrollmentPathBody ul,
            .af-enrollmentPathBody ol {
                margin: 0px;
                padding: 0px;
            }
            
            .af-enrollmentPathRecommendedEmphasis {
                text-align: center;
                color: #46b152;
                font-weight: bold;
                font-style: italic;
            }
            
            input.af-enrollmentPathCheckbox {
                height: 25px;
                width: 25px;
            }
            
            .af-enrollmentPathDetailsContainer {
                text-align: right;
                position: absolute;
                bottom: 10px;
                right: 15px;
            }
            
            .af-enrollmentPathDetails {
                font-style: italic;
                text-decoration: underline;
                font-weight: bold;
            }
            
            .af-enrollmentPathNotSelected {
                background-color: #eaecec;
            }
            
            .row-eq-height {
                display: -webkit-box;
                display: -webkit-flex;
                display: -ms-flexbox;
                display: flex;
            }
            
            .af-enrollmentPathTopContainer {
                margin-left: -10px;
            }
            
            .af-enrollmentPathHeader {
                margin-left: 5px;
                margin-top: 0.5rem;
            }

            .af-payroll-rush {
                color: red;
                font-weight: bold;
            }
        </style>
        
    </head>
    <body>
        
        <apex:pageBlock id="thePageBlock">
            <apex:form id="theForm">
                <script>
                var $ = jQuery.noConflict();
                var enrollmentStartDateChanged = false;

                // Luke Freeland: Added this so Salesforce won't automatically set
                // focus to a date field.
                function setFocusOnLoad() {}
                
                </script>
                <apex:outputPanel id="page">
                    <!---------------------------- TAB DEFINITIONS -------------------------------------->
                    <div class="container af-container" >
                        <div class="af-header">
                            
                        <c:SetupFormsNavBar id="navBarComponent" formName="generalInfo" submitLabel="Confirm & Continue" 
                                            efId="{!ef.Id}" 
                                            requestEditText="{! $Label.General_Information_Request_Edit_Button_Hidden_Reason }"/>
                    
                        <div class="header-tabs">
                            <apex:outputPanel id="tabPanel">
                                <ul class="nav nav-tabs" id="tabs">
                                    <li><a id="detailsTabLink" data-toggle="tab" href="#detailsTab" style="{!if(detailsTabComplete ,'color:black','color:red')}">
                                        Account &amp; Enrollment Details</a></li>
                                    <li><a id="marketedTabLink" data-toggle="tab" href="#marketedTab" style="{!if(productTabComplete ,'color:black','color:red')}">
                                        Marketed Products &amp; Services</a></li>
                                    <li><a id="enrollmentTeamTabLink" data-toggle="tab" href="#enrollmentTeamTab" style="{!if(enrollmentTabComplete ,'color:black','color:red')}">Account Contacts</a></li>
                                </ul>   
                                <script>
                                // tab event handler.  Use to enable/disable buttons. Needs to be here due to rerendering of tabPanel  
                                var currentTab;
                                $('.nav-tabs a').on('show.bs.tab', function(){
                                    if ($(this).parent().is(':last-child')) {
                                        $("#nextTabButton").hide();
                                        
                                        if ({!formIsSubmitted == false}) {
                                            $("#submitAndContinueButton").show();
                                        }
                                    }
                                    else {
                                        $("#nextTabButton").show();
                                        $("#submitAndContinueButton").hide();
                                    }
                                    
                                    if ($(this).parent().is(':first-child'))
                                        $("#prevTabButton").hide();
                                    else
                                        $("#prevTabButton").show();
                                    
                                    currentTab='#'+$(this).attr('id');
                                    console.log('**** tab: '+currentTab);
                                });
                                
                                function nextTab() {
                                    $('#tabs > .active').next('li').find('a').click();
                                } 
                                
                                function  prevTab() {
                                    $('#tabs > .active').prev('li').find('a').click();
                                }

                                </script>    
                            </apex:outputPanel>
                        </div> <!-- end header-tabs -->
                        
                        </div>
                        <div class="content">
                            <apex:outputPanel id="messages" styleClass="msgs">
                                <apex:pageMessages rendered="{!showErrorMessages==true}"/>
                            </apex:outputPanel>

                            <span id="submitMessage" style="margin-left:10px;font-size:16pt;color:red;display:none"></span>

                            <apex:outputPanel id="allTabs">
                                
                                <script>
                                
                                // this will display the contents of a tab clicked via javascript
                                $('.nav').click(function (e) {
                                    e.preventDefault();
                                    $(this).tab('show');
                                }) ;        
                                
                                </script>
                                <div class="tab-content">
                                    <!--------------------------------------------DETAILS TAB  ----------------------------------------- -->
                                    <!--------------------------------------------DETAILS TAB  ----------------------------------------- -->
                                    <!--------------------------------------------DETAILS TAB  ----------------------------------------- -->
                                    <!--------------------------------------------DETAILS TAB  ----------------------------------------- -->
                                    
                                    <div class="tab-pane active" id="detailsTab" style="padding-left:30px">
                                        <apex:outputPanel id="detailsPanel" >
                                            
                                            <div class="sectionHeader">
                                                <apex:outputText styleclass="sectionLabel" value="Account Information"/>
                                            </div>
                                            
                                            <table id="accountInformation" class="formtable" style="width:100%">
                                                <!-- 1 -->
                                                <tr>
                                                    <td  class="fieldLabel"><div class="{! If(IsReservice == false, 'requiredLabel', '') }">{! $ObjectType.Opportunity.Fields.Group_Name__c.Label }<c:cHelp helpText="{!hMap[LOWER('Group_Name__c')]}"/></div></td>
                                                    <td class="fieldLabel">
                                                        <apex:outputPanel layout="none" rendered="{! IsNewSetup == false }">
                                                        {! $ObjectType.Opportunity.Fields.MCP_Number__c.Label }<c:cHelp helpText="{!hMap[LOWER('MCP_Number__c')]}"/>
                                                        </apex:outputPanel>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td><apex:inputField value="{!opportunity.Group_Name__c}" onchange="saveRecord();" rendered="{! IsReservice == false }"/>
                                                        <apex:outputField value="{!opportunity.Group_Name__c}" rendered="{! IsReservice }" /></td>
                                                    <td><apex:outputField value="{!opportunity.MCP_Number__c}" rendered="{! IsNewSetup == false }" /></td>
                                                </tr>

                                                <!-- 2 -->
                                                <tr>
                                                    <td class="fieldLabel"><div class="requiredLabel">{! $ObjectType.Opportunity.Fields.Assigned_Account_Manager__c.Label }<c:cHelp helpText="{!hMap[LOWER('Assigned_Account_Manager__c')]}"/></div></td>
                                                    <td  class="fieldLabel">
                                                        <apex:outputPanel layout="none" rendered="{! IsNewSetup == false }">
                                                        {! $ObjectType.Opportunity.Fields.Additional_MCPs__c.Label }<c:cHelp helpText="{!hMap[LOWER('Additional_MCPs__c')]}"/>
                                                        </apex:outputPanel>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td><apex:inputField id="acctMgr" value="{!opportunity.Assigned_Account_Manager__c}" onchange="saveRecord();"/></td>
                                                    <td style="vertical-align:top;"><apex:inputField value="{!opportunity.Additional_MCPs__c}" onchange="saveRecord();" rendered="{! IsNewSetup == false }" /></td>
                                                </tr>

                                                <!-- 3 -->
                                                <tr>
                                                    <td class="fieldLabel"><div class="requiredLabel">{! $ObjectType.Opportunity.Fields.Estimated_Employees__c.Label }<c:cHelp helpText="{!hMap[LOWER('Estimated_Employees__c')]}"/></div></td>
                                                    <td class="fieldLabel"><apex:outputPanel layout="none" rendered="{! eOppty.Confirm_New_or_Existing_Group__c != 'Existing' }"><div class="requiredLabel">Tax ID#<c:cHelp helpText="{!hMap[LOWER('Tax_ID__c')]}"/></div></apex:outputPanel></td>
                                                </tr>
                                                <tr>
                                                    <td><apex:inputField value="{!opportunity.Estimated_Employees__c}" styleClass="numeric3"  onchange="saveRecord();"/></td>
                                                    <td ><apex:inputField id="taxId"  value="{!opportunity.Tax_ID__c}" onchange="saveRecord();" html-maxlength="10" onkeypress="return allowTaxIdCharacters(event);" rendered="{! eOppty.Confirm_New_or_Existing_Group__c != 'Existing' }" /></td>
                                                    
                                                </tr>
                                                
                                                <!-- 4 -->
                                                <tr>
                                                    <td class="fieldLabel"><div class="requiredLabel">Employee Eligibility Waiting Period<c:cHelp helpText="{!hMap[LOWER('EE_Eligibility_Waiting_Period__c')]}"/></div></td>
                                                    <td class="fieldLabel">
                                                        <apex:outputPanel layout="none" rendered="{! IsReservice == false }">
                                                        Legal Name Different<c:cHelp helpText="{!hMap[LOWER('Legal_Name_is_different_than_Group_Name__c')]}"/>
                                                        </apex:outputPanel>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>
                                                        <apex:inputField value="{!opportunity.EE_Eligibility_Waiting_Period__c}" onchange="saveRecord(); toggleEmployeeOtherWaitingPeriod(this.value);"/>

                                                        <div class="requiredLabel fieldLabel otherEligibilityWaitingPeriod af-noDisplay">{! $ObjectType.Opportunity.Fields.Other_Eligibility_Waiting_Period__c.Label }<c:cHelp helpText="{!hMap[LOWER('Other_Eligibility_Waiting_Period__c')]}"/></div>
                                                        <apex:inputField value="{!opportunity.Other_Eligibility_Waiting_Period__c}" onchange="saveRecord();" styleClass="otherEligibilityWaitingPeriod af-noDisplay" style="margin-top: 10px;" />
                                                    </td>                                                    
                                                    <td style="vertical-align: top;"><apex:inputField value="{!opportunity.Legal_Name_is_different_than_Group_Name__c}" onclick="saveRecord();" rendered="{! IsReservice == false }"/></td>
                                                </tr>
                                                
                                                <!-- 5 -->
                                                <tr>
                                                    <td class="fieldLabel"><div class="requiredLabel">{! $ObjectType.Opportunity.Fields.Waiting_Period_Effective__c.Label }<c:cHelp helpText="{!hMap[LOWER('Waiting_Period_Effective__c')]}"/></div></td>
                                                    <td class="fieldLabel">
                                                        <apex:outputPanel layout="none" rendered="{! IsReservice == false }">
                                                        {! $ObjectType.Opportunity.Fields.Legal_Name__c.Label }<c:cHelp helpText="{!hMap[LOWER('Legal_Name__c')]}"/>
                                                        </apex:outputPanel>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>
                                                        <apex:inputField value="{!opportunity.Waiting_Period_Effective__c}" onchange="saveRecord();"/>
                                                    </td>
                                                    <td><apex:inputField value="{!opportunity.Legal_Name__c}" onchange="saveRecord();" rendered="{! IsReservice == false }" /></td>
                                                </tr>

                                                <!-- 6 -->
                                                <tr>
                                                    <td class="fieldLabel"><div class="requiredLabel">{! $ObjectType.Opportunity.Fields.Residence_State_s__c.Label }<c:cHelp helpText="{!hMap[LOWER('Residence_State_s__c')]}"/></div></td>
                                                </tr>
                                                <tr>
                                                    <td rowspan="3" style="vertical-align: top;">
                                                        <div>
                                                            <apex:inputField id="residenceStates" value="{!opportunity.Residence_State_s__c}"   styleClass=" myMultiClass" onchange="saveRecord();"/>
                                                        </div>
                                                    </td>
                                                </tr>
                                            </table>
                                            
                                            
                                            <script>
                                            // script needs to rerun when panel is rerendered
                                            $("input.numeric3").numeric(",");
                                            </script>
                                            
                                            
                                            <div class="sectionHeader">
                                                <apex:outputText styleclass="sectionLabel" value="Key Enrollment Dates"/>
                                            </div>
                                            
                                            <div id="enrollmentRushWarningMsgContainer" style="display:none;">
                                                <apex:outputText value="{! $Label.Enrollment_Rush_Warning_Message }" escape="false" />
                                            </div>
                                            
                                            <table id="keyEnrollmentDates" class="formtable" style="width:100%">
                                                <tr>
                                                    <td class="fieldLabel" ><div class="requiredLabel">{! $ObjectType.Opportunity.Fields.Enrollment_Start_Date__c.Label }<c:cHelp helpText="{!hMap[LOWER('Enrollment_Start_Date__c')]}"/></div></td>
                                                    <td class="fieldLabel"><div class="requiredLabel">{! $ObjectType.Opportunity.Fields.Effective_Date_of_AFA_Products__c.Label }<c:cHelp helpText="{!hMap[LOWER('Effective_Date_of_AFA_Products__c')]}"/></div></td>
                                                </tr>
                                                <tr>
                                                    <td ><apex:inputField id="enrollmentStartDate" value="{!opportunity.Enrollment_Start_Date__c}" styleClass="dateInput leaveUnlocked" onchange="enrollmentStartDateChanged = true; saveRecordandRerenderPlatform(); toggleEnrollmentRushWarningMessage(this.value); " >
                                                        </apex:inputField>
                                                        
                                                    </td>
                                                    <td ><apex:inputField value="{!opportunity.Effective_Date_of_AFA_Products__c}" onchange="saveRecord();" styleClass="dateInput" /></td>
                                                </tr>
                                                <tr>
                                                    <td class="fieldLabel" ><div class="requiredLabel">{! $ObjectType.Opportunity.Fields.Enrollment_End_Date__c.Label }<c:cHelp helpText="{!hMap[LOWER('Enrollment_End_Date__c')]}"/></div></td>
                                                    <td class="fieldLabel" >{! $ObjectType.Opportunity.Fields.Effective_Date_of_Core_Products__c.Label }<c:cHelp helpText="{!hMap[LOWER('Effective_Date_of_Core_Products__c')]}"/></td>
                                                </tr>
                                                <tr>
                                                    <td ><apex:inputField id="enrollmentEndDate" value="{!opportunity.Enrollment_End_Date__c}" onchange="saveRecord(); setPayrollRushReasonVisibility();" styleClass="dateInput leaveUnlocked" /></td>
                                                    <td ><apex:inputField value="{!opportunity.Effective_Date_of_Core_Products__c}" onchange="saveRecord();" styleClass="dateInput" /></td>
                                                </tr>
                                                <tr>
                                                    <td class="fieldLabel" >{! $ObjectType.Opportunity.Fields.Plan_Date_New__c.Label }<c:cHelp helpText="{!hMap[LOWER('Plan_Date_New__c')]}"/></td>
                                                </tr>
                                                <tr>
                                                    <td ><apex:inputField value="{!opportunity.Plan_Date_New__c}" onchange="saveRecord();" styleClass="dateInput" /></td>
                                                    <td> <a id="enrollmentEventLink" href="#" onclick="$('#createEnrollmentEvent').dialog('open')" >+ Create Enrollment Event</a></td>
                                                </tr>
                                            </table>     
                                            
                                            
                                            <div class="sectionHeader">
                                                <apex:outputText styleclass="sectionLabel" value="Platform Details"/>
                                            </div>
                                            
                                            
                                            <apex:outputPanel id="platformDetails">
                                                <div class="af-enrollmentPathHeader">
                                                    <div><strong>Enrollment Path</strong></div>
                                                    <div>Please select an enrollment path.</div>
                                                </div>
                                                
                                                <apex:outputPanel style="margin-top: 10px;" layout="block" rendered="{! IsBlank(enrollmentPathRequiredMessage) = false && enrollmentPathRequiredMessage != '' }">
                                                    <apex:pageMessage severity="Error" summary="{! enrollmentPathRequiredMessage }"  />
                                                </apex:outputPanel>
                                            
                                                <div class="row row-eq-height af-enrollmentPathTopContainer">
                                                
                                                <apex:repeat value="{! enrollmentPaths }" var="ep">
                                                    <div class="af-enrollmentPathContainer {! IF(ep.Recommended__c == true, 'af-enrollmentPathRecommended', '') } {! IF(eOppty.Enrollment_Path__c != null && ep.Id != eOppty.Enrollment_Path__c, 'af-enrollmentPathNotSelected', '') }"
                                                         id="enrollmentPathContainer{! ep.Id }">
                                                        <div class="af-enrollmentPathTitle">
                                                            <input type="checkbox" class="af-enrollmentPathCheckbox" onchange="changeEnrollmentPath(this);" enrollment-path="{! ep.Id }" enrollment-path-selected="{! ep.Id == eOppty.Enrollment_Path__c }" />
                                                            {! ep.Name }
                                                        </div>
                                                        
                                                        <div class="af-enrollmentPathBody">
                                                            <apex:outputText value="{! ep.Summary__c }" escape="false" />
                                                        </div>
                                                        
                                                        <apex:outputPanel layout="block" rendered="{! ep.Recommended__c == true }" styleClass="af-enrollmentPathRecommendedEmphasis">
                                                        {! ep.Recommended_Text__c }
                                                        </apex:outputPanel>
                                                        
                                                        <div class="af-enrollmentPathDetailsContainer">
                                                            <a class="af-enrollmentPathDetails" data-toggle="modal" href="#enrollmentPathModal{! ep.Id }"
                                                               data-backdrop="false" data-keyboard="true">Details</a>
                                                        </div>
                                                    </div>
                                                    
                                                    <!-- Modal -->
                                                    <div class="modal fade collapse" id="enrollmentPathModal{! ep.Id }" role="dialog">
                                                        <div class="modal-dialog">
                                                            <!-- Modal content-->
                                                            <div class="modal-content">
                                                                <div class="modal-header">
                                                                    <h4 class="modal-title">{!ep.Name} Details</h4>
                                                                </div>
                                                                <div class="modal-body">
                                                                    <p><apex:outputText value="{!ep.Description__c}" escape="false" /></p>
                                                                    
                                                                    <p style="display: {! IF(eOppty.Division__c == 'AFES', '', 'none') }; margin-top: 1rem;"><apex:outputText value="{!ep.Level__c}" escape="false" /></p>
                                                                </div>
                                                                <div class="modal-footer">
                                                                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </apex:repeat>
                                                </div>
                                                
                                                <apex:outputPanel id="enrollmentRushRequestPanel" rendered="{! enrollmentRushRequested == true || IsBlank(opportunity.Enrollment_Rush_Request_Reason__c) = false }" layout="block">
                                                    <div><apex:outputText value="{! $Label.Enrollment_Rush_Request_Reason }" escape="false" /></div>
                                                    
                                                    <table class="formtable" style="width:100%">
                                                        <tr>
                                                            <td class="fieldLabel" ><div class="requiredLabel">{! $ObjectType.Opportunity.Fields.Enrollment_Rush_Request_Reason__c.Label }<c:cHelp helpText="{!hMap[LOWER('Enrollment_Rush_Request_Reason__c')]}"/></div></td>
                                                        </tr>
                                                        <tr>
                                                            <td><apex:inputField value="{!opportunity.Enrollment_Rush_Request_Reason__c}" onchange="saveRecord();" style="min-width: 700px;" /></td>
                                                        </tr>
                                                    </table>
                                                </apex:outputPanel>
                                                
                                                <apex:outputPanel rendered="{! enrollmentEmployeeThresholdShort }" layout="block">
                                                    <div><apex:outputText value="{! enrollmentEmployeeShortMessage }" escape="false" /></div>
                                                    
                                                    <table class="formtable" style="width:100%">
                                                        <tr>
                                                            <td class="fieldLabel" ><div class="requiredLabel">{! $ObjectType.Platform_Setup__c.Fields.Below_Eligible_Employee_Threshold_Reason__c.Label }<c:cHelp helpText="{!hMap[LOWER('Below_Eligible_Employee_Threshold_Reason__c')]}"/></div></td>
                                                        </tr>
                                                        <tr>
                                                            <td><apex:inputField value="{!ps.Below_Eligible_Employee_Threshold_Reason__c}" onchange="updatePlatformSetupForEnrollmentPath();" style="min-width: 700px;" /></td>
                                                        </tr>
                                                    </table>
                                                </apex:outputPanel>
                                            
                                                <table id="platformDetails" class="formtable">
                                                    <tr>
                                                        <td class="fieldLabel" ><div class="requiredLabel">{! $ObjectType.Platform_Setup__c.Fields.Enroll_Info_Service_Process__c.Label }<c:cHelp helpText="{!hMap[LOWER('Enroll_Info_Service_Process__c')]}"/></div></td>
                                                    </tr>
                                                    <tr>
                                                        <td><apex:inputField value="{!ps.Enroll_Info_Service_Process__c}"  onchange="updatePlatformSetup('Enroll_Info_Service_Process__c', this.value);" />
                                                            <img src="/img/alohaSkin/help_grey.png" id="serviceProcessHelp" data-toggle="popover"   style="vertical-align:middle" />
                                                        </td>
                                                    </tr>
                                                </table>
                                                
                                                <c:EnrollmentSectionForm fieldSetName="{! EnrollmentPathPlatformSetupFieldSet }"
                                                                         record="{! ps }"
                                                                         onChangeFunctionNameToCall="updatePlatformSetupForEnrollmentPath"
                                                                         numberOfLayoutColumns="1"
                                                                         rendered="{! EnrollmentPathPlatformSetupFieldSet != null && EnrollmentPathPlatformSetupFieldSet != '' }"  />
                                                <script>

                                                $( ".helpButton" ).hover(
                                                    function() {
                                                        $(this).addClass("helpButtonOn");
                                                        $(this).removeClass("helpButton");
                                                        $(this).children('span.spanText').css("display", "inline");
                                                    }, function() {
                                                        $(this).removeClass("helpButtonOn");
                                                        $(this).addClass("helpButton");
                                                        $(this).children('span.spanText').css("display", "none");
                                                    }
                                                );  
                                                </script>
                                            </apex:outputPanel>
                                            
                                            
                                            <div class="sectionHeader">
                                                <apex:outputText styleclass="sectionLabel" value="Enrollment Details"/>
                                            </div>
                                            
                                            
                                            
                                            <apex:outputPanel id="enrollmentDetails">
                                                <table  class="formtable" style="width:100%">
                                                    <tr>
                                                        <td class="fieldLabel" style="vertical-align:top;" >{! $ObjectType.Opportunity.Fields.Enrollment_Setup_Notes__c.Label }<c:cHelp helpText="{!hMap[LOWER('Enrollment_Setup_Notes__c')]}"/></td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="3"><apex:inputTextArea value="{!opportunity.Enrollment_Setup_Notes__c}" style="width:700px" rows="4" onchange="saveRecord()" /></td>
                                                    </tr>
                                                    <tr>
                                                        <td style="vertical-align:top" class="fieldLabel">Enrollment Conditions<c:cHelp helpText="{!hMap[LOWER('Working_Conditions__c')]}"/></td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="3"><apex:inputField id="enrollmentDetailsField" value="{!opportunity.Working_Conditions__c}" styleClass="myMultiClass" onchange="saveRecord();" /></td>
                                                    </tr>
                                                </table>
                                            </apex:outputPanel>
                                            
                                            <div class="sectionHeader">
                                                <apex:outputText styleclass="sectionLabel" value="Enrollment Team"/>
                                            </div>
                                            
                                            
                                            <apex:outputPanel id="oppTeamPanel">
                                                
                                                <table id="AccountManagerTable" class="formtable" style="width:50%">
                                                    <tr id="NewAccountManagerLookup">
                                                        <td style="padding-top:15px">Add Enrollment Team Member<c:cHelp helpText="{!hMap[LOWER('UserId')]}"/></td>
                                                    </tr>
                                                    <tr>
                                                        <td width="30%"><apex:inputField id="otm" value="{!otm.UserId}" required="false" 
                                                                                         onchange="if($('[Id$=otm_lkid]').val() != '000000000000000') insertOTM($('[Id$=otm_lkid]').val());" /></td>
                                                        
                                                    </tr>
                                                </table>      
                                                <table style="margin-top:15px;width:75%" class="table table-bordered">
                                                    <thead style="background-color:#2989d8; color:#FFF">
                                                        <tr> 
                                                            <th/>
                                                            <th>Team Member</th>
                                                            <th>Network Id</th>
                                                            <th>Agent No.</th>
                                                        </tr>
                                                    </thead>
                                                    <apex:repeat value="{!oppTeamOwner}" var="o">
                                                        <tr >
                                                            <td style="width:75px"></td>
                                                            <td >{!o.User.Name}</td>
                                                            <td>{!o.user.Network_Id__c}</td>
                                                            <td>{!o.user.Agent_ID__c}</td>
                                                            
                                                            
                                                        </tr>
                                                    </apex:repeat>
                                                    <apex:repeat value="{!oppTeam}" var="o">
                                                        <tr>
                                                            <td style="width:75px"><a href="#" onclick="deleteOppTeamMember('{!o.Id}');">[Remove]</a></td>
                                                            <td>{!o.User.Name}</td>
                                                            <td>{!o.user.Network_ID__c}</td>
                                                            <td>{!o.user.Agent_ID__c}</td>
                                                        </tr>
                                                    </apex:repeat>
                                                </table>
                                            </apex:outputPanel>
                                            
                                            
                                            <div class="sectionHeader">
                                                <apex:outputText styleclass="sectionLabel" value="Address Information"/>
                                            </div>
                                            
                                            
                                            
                                            <table style="width:100%" class="formtable" >
                                                <tr>
                                                    <td class="fieldLabel">Billing Address</td>
                                                    <td class="fieldLabel">Physical Address</td>
                                                </tr>
                                            </table>
                                            
                                            
                                            <table id="addressInformation" class="formtable" style="width:100%">
                                                <tr>
                                                    <td class="fieldLabel" style="vertial-alighment:top"><div class="requiredLabel">Street<c:cHelp helpText="{!hMap[LOWER('BillingStreet')]}"/></div></td>
                                                    <td class="fieldLabel"><div class="requiredLabel">Same as Billing Address?<c:cHelp helpText="{!hMap[LOWER('Physical_Address_Same_As_Billing__c')]}"/></div></td>
                                                </tr>
                                                <tr>
                                                    <td><apex:inputField id="AccountBillingStreet" value="{!acc.BillingStreet}" onchange="updateAccountField('{!acc.Id}', 'BillingStreet', this.value);checkRequired(this);"/></td>
                                                    <td style="vertical-align:top"><apex:inputField value="{!opportunity.Physical_Address_Same_As_Billing__c}" id="addressSame" onchange="SetPhysicalAddress(this.value); togglePhysicalAddressVisibility(this.value);" /></td>
                                                </tr> 
                                                <tr>
                                                    <td class="fieldLabel"><div class="requiredLabel">City<c:cHelp helpText="{!hMap[LOWER('BillingCity')]}"/></div></td>
                                                    <td class="fieldLabel" id="physicalStreet">Street<c:cHelp helpText="{!hMap[LOWER('ShippingStreet')]}"/></td>
                                                </tr>
                                                <tr>
                                                    <td style="vertical-align:top"><apex:inputField id="AccountBillingCity" value="{!acc.BillingCity}" onchange="updateAccountField('{!acc.Id}', 'BillingCity', this.value);checkRequired(this);"/></td>
                                                    <td><apex:inputField id="AccountShippingStreet" value="{!acc.ShippingStreet}" onchange="updateAccountField('{!acc.Id}', 'ShippingStreet', this.value);"/></td>
                                                </tr>
                                                <tr>
                                                    <td class="fieldLabel"><div class="requiredLabel">State<c:cHelp helpText="{!hMap[LOWER('BillingState')]}"/></div></td>
                                                    <td class="fieldLabel" id="physicalCity">City<c:cHelp helpText="{!hMap[LOWER('ShippingCity')]}"/></td>
                                                </tr>
                                                <tr>
                                                    <td><apex:inputField id="AccountBillingState" value="{!acc.BillingState}" onchange="updateAccountField('{!acc.Id}', 'BillingState', this.value);checkRequired(this);"/></td>
                                                    <td><apex:inputField id="AccountShippingCity" value="{!acc.ShippingCity}" onchange="updateAccountField('{!acc.Id}', 'ShippingCity', this.value);"/></td>
                                                </tr>
                                                <tr>
                                                    <td class="fieldLabel"><div class="requiredLabel">Zip Code<c:cHelp helpText="{!hMap[LOWER('BillingPostalCode')]}"/></div></td>
                                                    <td class="fieldLabel" id="physicalState">State<c:cHelp helpText="{!hMap[LOWER('ShippingState')]}"/></td>
                                                </tr>
                                                <tr>
                                                    <td><apex:inputField id="AccountBillingPostalCode" value="{!acc.BillingPostalCode}" onchange="updateAccountField('{!acc.Id}', 'BillingPostalCode', this.value);checkRequired(this);"/></td>
                                                    <td><apex:inputField id="AccountShippingState" value="{!acc.ShippingState}" onchange="updateAccountField('{!acc.Id}', 'ShippingState', this.value);"/></td>
                                                </tr>
                                                <tr>
                                                    <td class="fieldLabel"></td>
                                                    <td class="fieldLabel" id="physicalZip">Zip Code<c:cHelp helpText="{!hMap[LOWER('ShippingPostalCode')]}"/></td>
                                                </tr>
                                                <tr>
                                                    <td/>
                                                    <td><apex:inputField id="AccountShippingPostalCode" value="{!acc.ShippingPostalCode}" onchange="updateAccountField('{!acc.Id}', 'ShippingPostalCode', this.value);"/></td>
                                                </tr> 
                                                 
                                            </table>
                                            
                                            <div class="sectionHeader">
                                                <apex:outputText styleclass="sectionLabel" value="Payroll Information"/>
                                            </div>
                                            
                                            
                                            <div>  <!-- to make these two tables appear side by side -->
                                                <div style="float:left;width:500px">
                                                    <apex:outputPanel id="payrollInfo">
                                                        <table id="payrollInformation" class="formtable" >
                                                            <tr>
                                                                <td class="fieldLabel" ><div class="requiredLabel">{! $ObjectType.Platform_Setup__c.Fields.Enroll_Info_First_Payroll_Deduction_Date__c.Label }<c:cHelp helpText="{!hMap[LOWER('Enroll_Info_First_Payroll_Deduction_Date__c')]}"/></div></td>
                                                            </tr>
                                                            <tr>
                                                                <td ><apex:inputField value="{!ps.Enroll_Info_First_Payroll_Deduction_Date__c}"  onchange="updatePlatformSetup('Enroll_Info_First_Payroll_Deduction_Date__c', this.value);" /></td>
                                                            </tr>

                                                            <tr>
                                                                <td class="fieldLabel">{! $ObjectType.Platform_Setup__c.Fields.Enroll_Info_Payroll_Company__c.Label }<c:cHelp helpText="{!hMap[LOWER('Enroll_Info_Payroll_Company__c')]}"/></td>
                                                            </tr>
                                                            <tr>
                                                                <td><apex:inputField value="{!ps.Enroll_Info_Payroll_Company__c}" onchange="updatePlatformSetup('Enroll_Info_Payroll_Company__c',this.value);"/></td>
                                                            </tr>
                                                            
                                                            <apex:outputPanel layout="none" rendered="{! eOppty.Confirm_New_or_Existing_Group__c == 'Existing' }">
                                                            <tr>
                                                                <td><apex:outputText value="{! $Label.AFEnroll_PayGroups_Disclaimer }" escape="false" styleClass="af-afenroll-payroll-group" /></td>
                                                            </tr>
                                                            <tr>
                                                                <td class="fieldLabel">{! $ObjectType.Account.Fields.AFenroll_Pay_Groups__c.Label }</td>
                                                            </tr>
                                                            <tr>
                                                                <td><apex:outputField value="{!eOppty.Account.AFenroll_Pay_Groups__c}" /></td>
                                                            </tr>
                                                            
                                                            <tr>
			                                                    <td class="fieldLabel"><div class="requiredLabel">{! $ObjectType.Opportunity.Fields.Are_you_changing_AFenroll_Frequencies__c.Label }<c:cHelp helpText="{!hMap[LOWER('Are_you_changing_AFenroll_Frequencies__c')]}"/></div></td>
			                                                </tr>
			                                                
			                                                <tr>
			                                                    <td><apex:inputField value="{!opportunity.Are_you_changing_AFenroll_Frequencies__c}"  onchange="saveRecord(); toggleNewAFEnrollDeductionFrequenciesVisibility(this.value);" /></td>
			                                                </tr>
			                                                
			                                                <tr class="newAFEnrollDeductionFreq">
			                                                    <td class="fieldLabel"><div class="requiredLabel">{! $ObjectType.Opportunity.Fields.New_AFenroll_Deduction_Frequencies__c.Label }<c:cHelp helpText="{!hMap[LOWER('New_AFenroll_Deduction_Frequencies__c')]}"/></div></td>
			                                                </tr>
			                                                
			                                                <tr class="newAFEnrollDeductionFreq">
			                                                    <td><apex:inputField value="{!opportunity.New_AFenroll_Deduction_Frequencies__c}"  onchange="saveRecord();" /></td>
			                                                </tr>
                                                            
                                                            
                                                            </apex:outputPanel>
                                                            
                                                            <apex:variable var="showPayrollDeductionBegins" value="{! ps.Enroll_Info_Payroll_Deduction_Begins__c != null && ps.Enroll_Info_Payroll_Deduction_Begins__c != '' }" />
                                                            <apex:variable var="showPayrollDeductionFrequency" value="{! ps.EnrollInfoPayrollDeductFrequenc__c != null && ps.EnrollInfoPayrollDeductFrequenc__c != '' }" />
                                                            <apex:variable var="showPayrollSkipMonths" value="{! ps.PayrollInfo9MoCheck__c == true || ps.PayrollInfoSkipMonths9__c != null || ps.PayrollInfo10MoCheck__c == true || ps.PayrollInfoSkipMonths10__c != null || ps.PayrollInfo11MoCheck__c == true || ps.PayrollInfoSkipMonths11__c != null }" />
                                                            
                                                            <apex:outputPanel layout="none" rendered="{! showPayrollDeductionBegins || showPayrollDeductionFrequency || showPayrollSkipMonths}">
                                                            <tr>
                                                                <td class="af-previouslyEnteredValuesHeader fieldLabel">
                                                                    <apex:outputText value="Previously Entered Values"/>
                                                                    <hr />
                                                                </td>
                                                            </tr>
                                                            </apex:outputPanel>
                                                            
                                                            <apex:outputPanel layout="none" rendered="{! showPayrollDeductionBegins }">
                                                            <tr>
                                                                <td class="fieldLabel" >{! $ObjectType.Platform_Setup__c.Fields.Enroll_Info_Payroll_Deduction_Begins__c.Label }</td>
                                                            </tr>
                                                            <tr>
                                                                <td><apex:outputField value="{!ps.Enroll_Info_Payroll_Deduction_Begins__c}" /></td>
                                                            </tr>
                                                            </apex:outputPanel>
                                                            
                                                            <apex:outputPanel layout="none" rendered="{! showPayrollDeductionFrequency }">
                                                            <tr>
                                                                <td class="fieldLabel" >{! $ObjectType.Platform_Setup__c.Fields.EnrollInfoPayrollDeductFrequenc__c.Label }</td>
                                                            </tr>
                                                            <tr>
                                                                <td><apex:outputField value="{!ps.EnrollInfoPayrollDeductFrequenc__c}" /></td>
                                                            </tr>
                                                            </apex:outputPanel>
                                                        </table>

                                                        <apex:outputPanel layout="none" rendered="{! showPayrollSkipMonths }">                                                        
                                                        <table class="formtable" > 
                                                            <tr>
                                                                <td class="fieldLabel" >Are there any skip months?</td>
                                                                <td></td>
                                                            </tr>
                                                        </table>
                                                        <table class="formtable" style="width:350px" > 
                                                            <tr>
                                                                <td style="width:150px"><apex:outputField value="{!ps.PayrollInfo9MoCheck__c}" />
                                                                                        {! $ObjectType.Platform_Setup__c.Fields.PayrollInfo9MoCheck__c.Label }
                                                                </td>
                                                                <td>{! $ObjectType.Platform_Setup__c.Fields.PayrollInfoSkipMonths9__c.Label } <br/>
                                                                    <apex:outputField value="{!ps.PayrollInfoSkipMonths9__c}"  style="width:200px" /></td>
                                                            </tr>
                                                            <tr>
                                                                <td style="width:150px"><apex:outputField value="{!ps.PayrollInfo10MoCheck__c}" />
                                                                                        {! $ObjectType.Platform_Setup__c.Fields.PayrollInfo10MoCheck__c.Label }
                                                                </td>
                                                                <td>{! $ObjectType.Platform_Setup__c.Fields.PayrollInfoSkipMonths10__c.Label }<br/>
                                                                    <apex:outputField value="{!ps.PayrollInfoSkipMonths10__c}"  style="width:200px" />
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td style="width:150px"><apex:outputField value="{!ps.PayrollInfo11MoCheck__c}" />
                                                                                        {! $ObjectType.Platform_Setup__c.Fields.PayrollInfo11MoCheck__c.Label }</td>
                                                                <td>{! $ObjectType.Platform_Setup__c.Fields.PayrollInfoSkipMonths11__c.Label }<br/>
                                                                    <apex:outputField value="{!ps.PayrollInfoSkipMonths11__c}"  style="width:200px" />
                                                                </td>
                                                            </tr>
                                                        </table>
                                                        </apex:outputPanel>
                                                        
                                                    </apex:outputPanel>
                                                </div>
                                                <div style="float:left; width:50%"> 
                                                    
                                                    <div>
                                                        <div class="fieldLabel">{! $ObjectType.Platform_Setup__c.Fields.Enroll_Info_Upload__c.Label }<c:cHelp helpText="{!hMap[LOWER('Enroll_Info_Upload__c')]}"/></div>
                                                    </div>
                                                    
                                                    <div>
                                                        <div><apex:inputField value="{!ps.Enroll_Info_Upload__c}"  onchange="showDueDate(this.value); updatePlatformSetup('Enroll_Info_Upload__c', this.value);" /></div>
                                                    </div>
                                                    
                                                    <div id="payrollFileUploadDueDateLabelRow">
                                                        <div class="fieldLabel dueDate" ><apex:outputText value="{! $ObjectType.Platform_Setup__c.Fields.EnrollInfoUploadDueDate__c.Label }" /><c:cHelp helpText="{!hMap[LOWER('EnrollInfoUploadDueDate__c')]}"/> </div>
                                                    </div>
                                                    <div id="payrollFileUploadDueDateInputRow">
                                                        <div class="dueDate"><apex:inputField id="payrollDueDate" value="{!ps.EnrollInfoUploadDueDate__c}" onchange="setPayrollRushReasonVisibility(); updatePlatformSetup('EnrollInfoUploadDueDate__c', this.value);"
                                                                             styleclass="dateInput" /></div>
                                                    </div>
                                                    <div class="payrollFileRush">
                                                        <div class="fieldLabel dueDate" ><div class="requiredLabel"><apex:outputText value="{! $ObjectType.Platform_Setup__c.Fields.Payroll_Due_Date_Rush_Reason__c.Label }" /><c:cHelp helpText="{!hMap[LOWER('Payroll_Due_Date_Rush_Reason__c')]}"/></div></div>
                                                    </div>
                                                    <div class="payrollFileRush">
                                                        <div class="payrollRushReason"><apex:inputField value="{!ps.Payroll_Due_Date_Rush_Reason__c}" onchange="updatePlatformSetup('Payroll_Due_Date_Rush_Reason__c', this.value);"/></div>
                                                    </div>
                                                    <div class="payrollFileRush af-payroll-rush">
                                                        <div><apex:outputText value="{! $Label.Payroll_Upload_Warning_Message }" escape="false"/></div>
                                                    </div>
                                                    
                                                </div>           
                                            </div>   <!-- end side by side -->

                                            <script>
                                                function showDueDate(value)
                                                {
                                                    if(value == 'Yes') {
                                                        showPayrollFileUploadDueDate();
                                                    }
                                                    else {
                                                        hidePayrollFileUploadDueDate();
                                                    }
                                                }
                                                
                                                function showPayrollFileUploadDueDate() {
                                                    $('#payrollFileUploadDueDateLabelRow').show();
                                                    $('#payrollFileUploadDueDateInputRow').show();
                                                    setPayrollRushReasonVisibility();

                                                }
                                                
                                                function hidePayrollFileUploadDueDate() {
                                                    $('#payrollFileUploadDueDateLabelRow').hide();
                                                    $('#payrollFileUploadDueDateInputRow').hide();
                                                    $('.payrollFileRush').hide();
                                                }

                                                function setPayrollRushReasonVisibility(){
                                                    var enrollmentEndDateInput = document.getElementById('{! $Component.enrollmentEndDate }');
                                                    var payrollDueDateInput = document.getElementById('{! $Component.payrollDueDate }');

                                                    $('.payrollFileRush').hide();
                                                    
                                                    if(!enrollmentEndDateInput){
                                                        return;
                                                    }

                                                    if(!payrollDueDateInput){
                                                        return;
                                                    }

                                                    var enrollmentEndDateString = enrollmentEndDateInput.value;

                                                    if (!enrollmentEndDateString) {
                                                        return;
                                                    }

                                                    var payrollDueDateString = payrollDueDateInput.value;

                                                    if(!payrollDueDateString){
                                                        return;
                                                    }

                                                    var businessDaysBetween = calcBusinessDays(payrollDueDateString, enrollmentEndDateString);

                                                    var businessDaysAllowed = {! $Label.Payroll_Due_Date_Threshold};

                                                    if(businessDaysBetween <= businessDaysAllowed){
                                                        $('.payrollFileRush').show();
                                                    }
                                                }

                                                function calcBusinessDays(start, end) {
                                                    var start = new Date(start);
                                                    var end = new Date(end);

                                                    var totalBusinessDays = 0;

                                                    start.setHours(0,0,0,0);
                                                    end.setHours(0,0,0,0);

                                                    var current = new Date(start);
                                                    current.setDate(current.getDate() + 1);
                                                    var day;
                                                    // loop through each day, checking
                                                    while (current <= end) {
                                                        day = current.getDay();
                                                        if (day >= 1 && day <= 5) {
                                                            ++totalBusinessDays;
                                                        }
                                                        current.setDate(current.getDate() + 1);
                                                    }
                                                    return totalBusinessDays;
                                                }

                                            </script>
                                                
                                        </apex:outputPanel>
                                        
                                    </div>    <!--  Details tab-->
                                    
                                    <!-----------------------------------------------------------------  MARKETED PRODUCTS TAB ----------------------------------------------------- -->
                                    <!-----------------------------------------------------------------  MARKETED PRODUCTS TAB ----------------------------------------------------- -->
                                    <!-----------------------------------------------------------------  MARKETED PRODUCTS TAB ----------------------------------------------------- -->
                                    
                                    
                                    <div class="tab-pane" id="marketedTab">
                                        
                                        <apex:outputPanel id="productsPanel">    <!-- included Marketed Products & Add Product -->
                                            <div id="marketedProducts">
                                                <apex:outputPanel id="marketedProductsPanel" >
                                                    
                                                    <input id="selectProductsBtn" type="button" value="Select Products"  onclick="$('#marketedProducts').hide();$('#productCatalog').show();" class="gbtn gbtnSecondary" style="margin-top: 10px;" />
                                                    
                                                    
                                                    <div style="margin-top:30px">
                                                        
                                                        <div class="sectionHeader">
                                                            <apex:outputText styleclass="sectionLabel" value="Benefit Products"/>
                                                        </div>
                                                        
                                                        
                                                        
                                                        <apex:outputPanel id="benefitProducts" >
                                                            <table style="margin-top:15px;width:80%" class="table table-bordered">
                                                                <thead style="background-color:#2989d8; color:#FFF">
                                                                    <tr>
                                                                        <th class="removeProduct"/>
                                                                        <th>Marketed Product Name</th>
                                                                        <th>Tax Treatment</th>
                                                                        <th>Plan Status</th>
                                                                        <th>Rider</th>
                                                                        <th>{! $ObjectType.Marketed_Product__c.Fields.Employer_Paid_Portion__c.Label}</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <apex:repeat value="{!mProducts_ben}"  var="mp">
                                                                        
                                                                        <apex:variable var="rowclass" value="{!if(mp.Plan_Status__c=='New','greenText','normalText')}"/>    
                                                                        <tr >
                                                                            <td class="removeProduct">
                                                                                <a href="#" onclick="$( '#prodDeleteConfirm' ).dialog('option','productId','{!mp.Id}')
                                                                                                     .text('You are about to delete {!mp.products__r.name} from Marketed Products.  Do you wish to proceed?')
                                                                                                     .dialog( 'open' ); return false;">[Remove]</a>
                                                                            </td>
                                                                            <td class="{!rowclass}" style="width:30%; font-weight:bold" ><apex:outputField value="{!mp.products__r.name}"/> </td>
                                                                            
                                                                            <td> <apex:inputField styleclass="{!rowclass}" value="{!mp.Tax_Treatment__c}" rendered="{!mp.products__r.Is_Tax_Treatment_Editable__c}"
                                                                                                  onchange="updateProduct('{!mp.id}', 'Tax_Treatment__c', this.value);"/>
                                                                                <apex:outputField styleclass="{!rowclass}" value="{!mp.Tax_Treatment__c}" rendered="{!mp.products__r.Is_Tax_Treatment_Editable__c == false}"/> 
                                                                            </td>
                                                                            
                                                                            <td styleclass="{!rowclass}" > 
                                                                                <apex:inputField styleclass="{!rowclass}" value="{!mp.Plan_Status__c}" onchange="updateProduct('{!mp.id}', 'Plan_Status__c', this.value);"/>
                                                                            </td>
                                                                            
                                                                            <td  style="width:5%;text-align:center"> <apex:outputField styleclass="{!rowclass}" value="{!mp.products__r.Rider__c}" /> </td>
                                                                        
                                                                            <td styleclass="{!rowclass}" > 
                                                                                <apex:inputField styleclass="{!rowclass}" value="{!mp.Employer_Paid_Portion__c}" onchange="updateProduct('{!mp.id}', 'Employer_Paid_Portion__c', this.value);"/>
                                                                            </td>
                                                                        </tr>
                                                                        
                                                                    </apex:repeat>
                                                                </tbody>
                                                            </table>
                                                            
                                                            
                                                        </apex:outputPanel>
                                                    </div>
                                                    
                                                    <div style="margin-top:30px">  
                                                        
                                                        <div class="sectionHeader">
                                                            <apex:outputText styleclass="sectionLabel" value="Service Products"/>
                                                        </div>
                                                        
                                                        
                                                        <apex:outputPanel id="serviceProducts" >
                                                            <table  style="margin-top:15px; width:50%" class="table table-bordered"> 
                                                                <thead style="background-color:#2989d8; color:#FFF">
                                                                    <tr>
                                                                        <th style="width:75px"  class="removeProduct"/>
                                                                        <th >Marketed Product Name</th>
                                                                        <th>Plan Status</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <apex:repeat value="{!mProducts_svc}"  var="mp">
                                                                        <apex:variable var="rowclass" value="{!if(mp.Plan_Status__c=='New','greenText','normalText')}"/>    
                                                                        
                                                                        <tr>
                                                                            <td class="removeProduct">
                                                                                <a href="#" onclick="$( '#prodDeleteConfirm' ).dialog('option','productId','{!mp.Id}')
                                                                                                     .text('You are about to delete {!mp.products__r.name} from Marketed Products.  Do you wish to proceed?')
                                                                                                     .dialog( 'open' ); return false;">[Remove]</a>
                                                                            </td>
                                                                            <td class="{!rowclass}"  style="font-weight:bold" > <apex:outputField value="{!mp.products__r.name}" styleClass="{!rowClass}"/> </td>
                                                                            
                                                                            <td > <apex:inputField styleclass="{!rowclass}" value="{!mp.Plan_Status__c}"
                                                                                                   onchange="updateProduct('{!mp.id}', 'Plan_Status__c', this.value);"/></td>
                                                                        </tr>
                                                                        
                                                                    </apex:repeat>
                                                                </tbody>
                                                            </table>
                                                        </apex:outputPanel>
                                                    </div>
                                                    
                                                    <div style="margin-top:30px">   
                                                        
                                                        
                                                        <div class="sectionHeader">
                                                            <apex:outputText styleclass="sectionLabel" value="Import Products"/>
                                                        </div>
                                                        
                                                        
                                                        <apex:outputPanel id="importProducts" >
                                                            <table  style="margin-top:15px; width:95%" class="table table-bordered">
                                                                <thead style="background-color:#2989d8; color:#FFF">
                                                                    <tr>
                                                                        <th style="width:75px" class="removeProduct"/>
                                                                        <th  style="width:20%">Marketed Product Name</th>
                                                                        <th style="width:100px">{! $ObjectType.Marketed_Product__c.Fields.Tax_Treatment__c.Label}</th>
                                                                        <th style="width:5%">{! $ObjectType.Marketed_Product__c.Fields.Plan_Status__c.Label}</th>
                                                                        <th style="width:5%">Is AFA the AOR?</th>
                                                                        <th style="width:5%">{! $ObjectType.Marketed_Product__c.Fields.Carrier__c.Label}</th>
                                                                        <th>{! $ObjectType.Marketed_Product__c.Fields.Product_Description__c.Label}</th>
                                                                        <th>{! $ObjectType.Marketed_Product__c.Fields.Employer_Paid_Portion__c.Label}</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <apex:repeat value="{!mProducts_imp}"  var="mp">
                                                                        <apex:variable var="rowclass" value="{!if(mp.Plan_Status__c=='New','greenText','normalText')}"/>    
                                                                        <tr>
                                                                            <td class="removeProduct"> 
                                                                                <a href="#" onclick="$( '#prodDeleteConfirm' ).dialog('option','productId','{!mp.Id}')
                                                                                                     .text('You are about to delete {!mp.products__r.name} from Marketed Products.  Do you wish to proceed?')
                                                                                                     .dialog('option','title','Please Confirm')                    
                                                                                                     .dialog('option','theme','confirmTitle')
                                                                                                     .dialog( 'open' ); return false;">[Remove]</a>
                                                                            </td>
                                                                            <td class="{!rowclass}" style="font-weight:bold" > <apex:outputField value="{!mp.products__r.name}"/> </td>
                                                                            <td> <apex:inputField styleclass="{!rowclass}" value="{!mp.Tax_Treatment__c}" rendered="{!mp.products__r.Is_Tax_Treatment_Editable__c}"
                                                                                                  onchange="updateProduct('{!mp.id}', 'Tax_Treatment__c', this.value);"/>
                                                                                <apex:outputField styleclass="{!rowclass}" value="{!mp.Tax_Treatment__c}" rendered="{!mp.products__r.Is_Tax_Treatment_Editable__c == false}"/> 
                                                                            </td>
                                                                            <td styleclass="{!rowclass}" > <apex:inputField styleclass="{!rowclass}" value="{!mp.Plan_Status__c}"
                                                                                                                            onchange="updateProduct('{!mp.id}', 'Plan_Status__c', this.value);"/>
                                                                            </td>
                                                                            <td> <apex:inputField styleclass="{!rowclass}" value="{!mp.AOR__c}" style="width:125px" onchange="updateProduct('{!mp.id}', 'AOR__c', this.value);"/> </td>
                                                                            <td> <apex:inputField styleclass="{!rowclass}" value="{!mp.Carrier__c}" style="width:125px" onchange="updateProduct('{!mp.id}', 'Carrier__c', this.value);"/> </td>
                                                                            
                                                                            <td> <apex:inputTextArea styleclass="{!rowclass}" value="{!mp.Product_Description__c}"  onchange="updateProduct('{!mp.id}', 'Product_Description__c', this.value);" rows="3" /> </td>
                                                                            <td styleclass="{!rowclass}" > 
                                                                                <apex:inputField styleclass="{!rowclass}" value="{!mp.Employer_Paid_Portion__c}" onchange="updateProduct('{!mp.id}', 'Employer_Paid_Portion__c', this.value);"/>
                                                                            </td>
                                                                        </tr>
                                                                        
                                                                    </apex:repeat>
                                                                </tbody>
                                                            </table>
                                                            
                                                            <div id="prodDeleteConfirm"/>
                                                            <div id="submitConfirm"/>
                                                            <div id="reserviceInfoMessage" >
                                                                <p>
                                                                    {! $Label.Redirect_From_Reservice }
                                                                </p>
                                                            </div>
                                                            
                                                            
                                                        </apex:outputPanel>  
                                                    </div>
                                                </apex:outputPanel>
                                            </div>
                                            <!----------------------------------------------  Add Products Dialog -------------------------------- --> 
                                            <!----------------------------------------------  Add Products Dialog -------------------------------- --> 
                                            
                                            <div id="productCatalog" style="display:none">
                                                
                                                <apex:outputPanel id="productCatalogPanel">
                                                    <div style="text-align:center;margin-bottom:15px; margin-left:40px;width:80%;">
                                                        <H4>Select Marketed Products to add to Enrollment</H4>
                                                    </div>
                                                    
                                                    
                                                    <input type="button" value="Add Products To Enrollment"  onclick="addSelectedProducts();" class="gbtn gbtnGreen" style="margin:20px 20px 20px 50px" /> 
                                                    <input type="button" value="Cancel"  onclick="$('#marketedProducts').show();$('#productCatalog').hide();" class="gbtn cancelBtn" />     
                                                    
                                                    
                                                    <!-- BENEFIT PRODUCTS -->
                                                    
                                                    <div class="sectionHeader">
                                                        <apex:outputText styleclass="sectionLabel" value="Benefit Products"/>
                                                    </div>
                                                    
                                                    <table style="margin-top:15px;width:75%" class="table table-bordered">
                                                        <thead style="background-color:#2989d8; color:#FFF">
                                                            <tr>
                                                                <th >Add</th>
                                                                <th >Marketed Product Name</th>
                                                                <th >{! $ObjectType.Marketed_Product__c.Fields.Tax_Treatment__c.Label}</th>
                                                                <th>{! $ObjectType.Marketed_Product__c.Fields.Plan_Status__c.Label}</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <apex:repeat value="{!catalogWrapper_ben}"  var="mp">
                                                                
                                                                <tr >
                                                                    <td style="width:50px">
                                                                        <apex:inputCheckbox value="{!mp.addProduct}" />
                                                                    </td>
                                                                    <td  style="font-weight:bold" ><apex:outputField value="{!mp.pCatalog.name}" style="width:200px"/> </td>
                                                                    <td>
                                                                        <apex:inputField value="{!mp.pCatalog.Tax_Treatment__c}" rendered="{!mp.pCatalog.Tax_Treatment__c==null || mp.pCatalog.Is_Tax_Treatment_Editable__c}" style="width:100px;"/>
                                                                        <apex:outputField value="{!mp.pCatalog.Tax_Treatment__c}" rendered="{!mp.pCatalog.Tax_Treatment__c!=null && mp.pCatalog.Is_Tax_Treatment_Editable__c == false}" style="width:100px"/> 
                                                                    </td>
                                                                    <td> 
                                                                        <apex:inputField value="{!mp.pCatalog.Plan_Status__c}" style="width:100px"/>
                                                                    </td>
                                                                </tr>
                                                                
                                                            </apex:repeat>
                                                        </tbody>
                                                    </table>
                                                    
                                                    <!-- SERVICE PRODUCTS -->
                                                    <div class="sectionHeader">
                                                        <apex:outputText styleclass="sectionLabel" value="Service Products"/>
                                                    </div>
                                                    
                                                    <table style="margin-top:15px;width:75%" class="table table-bordered">
                                                        <thead style="background-color:#2989d8; color:#FFF">
                                                            <tr>
                                                                <th>Add</th>
                                                                <th>Marketed Product Name</th>
                                                                <th>{! $ObjectType.Marketed_Product__c.Fields.Plan_Status__c.Label}</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <apex:repeat value="{!catalogWrapper_svc}"  var="mp">
                                                                
                                                                <tr >
                                                                    <td style="width:50px">
                                                                        <apex:inputCheckbox value="{!mp.addProduct}" />
                                                                    </td>
                                                                    <td  style="font-weight:bold" ><apex:outputField value="{!mp.pCatalog.name}" style="width:200px"/> </td>
                                                                    <td> 
                                                                        <apex:inputField value="{!mp.pCatalog.Plan_Status__c}" style="width:100px"/>
                                                                    </td>
                                                                </tr>
                                                                
                                                            </apex:repeat>
                                                        </tbody>
                                                    </table>
                                                    
                                                    
                                                    <div class="sectionHeader">
                                                        <apex:outputText styleclass="sectionLabel" value="Import Products"/>
                                                    </div>
                                                    
                                                    
                                                    <!-- IMPORT -->
                                                    <table style="margin-top:15px;" class="table table-bordered">
                                                        <thead style="background-color:#2989d8; color:#FFF">
                                                            <tr>
                                                                <th style="width:75px">Add</th>
                                                                <th style="width:200px">Marketed Product Name</th>
                                                                <th style="width:100px">{! $ObjectType.Marketed_Product__c.Fields.Tax_Treatment__c.Label}</th>
                                                                <th style="width:100px">{! $ObjectType.Marketed_Product__c.Fields.Plan_Status__c.Label}</th>
                                                                <th style="width:5%">Is AFA the AOR?</th>
                                                                <th style="width:5%">{! $ObjectType.Marketed_Product__c.Fields.Carrier__c.Label}</th>
                                                                <th>{! $ObjectType.Marketed_Product__c.Fields.Product_Description__c.Label}</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <apex:repeat value="{!catalogWrapper_imp}"  var="mpi">
                                                                
                                                                <tr >
                                                                    <td>
                                                                        <apex:inputCheckbox value="{!mpi.addProduct}" style="width:50px" />
                                                                    </td>
                                                                    <td  style="font-weight:bold;width:200px" ><apex:outputField value="{!mpi.pCatalog.name}" style="width:200px"/> </td>
                                                                    <td>
                                                                        <apex:inputField value="{!mpi.pCatalog.Tax_Treatment__c}" rendered="{!mpi.pCatalog.Tax_Treatment__c==null || mpi.pCatalog.Is_Tax_Treatment_Editable__c}" style="width:100px;"/>
                                                                        <apex:outputField value="{!mpi.pCatalog.Tax_Treatment__c}" rendered="{!mpi.pCatalog.Tax_Treatment__c!=null && mpi.pCatalog.Is_Tax_Treatment_Editable__c == false}" style="width:100px"/> 
                                                                    </td>
                                                                    <td> 
                                                                        <apex:inputField value="{!mpi.pCatalog.Plan_Status__c}" style="width:100px"/>
                                                                    </td>
                                                                    <td> <apex:inputField value="{!mpi.pCatalog.AOR__c}"      style="width:125px" /> </td>
                                                                    <td> <apex:inputField value="{!mpi.pCatalog.Carrier__c}"  style="width:125px" /> </td>
                                                                    <td> <apex:inputTextArea value="{!mpi.pCatalog.Product_Description__c}"  rows="3" /> </td>
                                                                    
                                                                </tr>
                                                                
                                                            </apex:repeat>
                                                        </tbody>
                                                    </table>
                                                    
                                                    
                                                    <input type="button" value="Add Products To Enrollment"  onclick="addSelectedProducts();" class="gbtn gbtnGreen" style="margin:20px 20px 20px 50px" /> 
                                                    <input type="button" value="Cancel"  onclick="$('#marketedProducts').show();$('#productCatalog').hide();" class="gbtn cancelBtn" />     
                                                    <script>
                                                    
                                                    $('.requiredBlock').css('display','none');
                                                    </script>
                                                    
                                                </apex:outputPanel>     <!-- end Add Products panel -->
                                            </div>                   <!-------------------- End Add Products Dialog --------------------- -->
                                        </apex:outputPanel>       <!-- end productsPanel -->
                                    </div>   <!----- Marketed Products Tab -->
                                    
                                    <!-----------------------------------------------------------------  ENROLLMENT TEAM TAB ----------------------------------------------------- -->
                                    <!-----------------------------------------------------------------  ENROLLMENT TEAM TAB ----------------------------------------------------- -->
                                    <!-----------------------------------------------------------------  ENROLLMENT TEAM TAB ----------------------------------------------------- -->
                                    
                                    
                                    <div class="tab-pane" id="enrollmentTeamTab">
                                        <apex:outputPanel id="enrollmentTeamPanel" >
                                            <div style="width:90%">    <!-- Wrapper -->
                                                
                                                
                                                <div class="sectionHeader" style="width:90%">
                                                    <apex:outputText styleclass="sectionLabel" value="Administrative Contact" />
                                                </div>
                                                
                                                <div style="float:left; width:45%">
                                                    
                                                    <table class="formtable"> 
                                                        <tr>
                                                            <td><br/></td>
                                                        </tr>
                                                        <tr>
                                                            <td class="fieldLabel"><div class="requiredLabel">Administrative Contact<c:cHelp helpText="{!hMap[LOWER('Administrative_Contact__c')]}"/></div></td>
                                                        </tr>
                                                        <tr>
                                                            <td><apex:inputField id="adminContact" styleclass="adminContact" value="{!eOppty.Administrative_Contact__c}">
                                                                <apex:actionSupport event="onchange"  action="{!save}" rerender="tabPanel, messages, enrollmentTeamPanel" oncomplete="setContact('adminContact','{!eOppty.Administrative_Contact__c}' )"/>
                                                                </apex:inputField>
                                                                &nbsp; <a  href="#" class="adminContact" onclick="$('#newContact').dialog('option','fieldName','adminContact').dialog('open')" >+ New</a>
                                                            </td>
                                                        </tr>
                                                        <tr class="adminContactField">
                                                            <td class="fieldLabel">Title<c:cHelp helpText="{!hMap[LOWER('Title')]}"/></td>
                                                        </tr>
                                                        <tr class="adminContactField">
                                                            <td><apex:inputField value="{!adminContact.Title}" onchange="updateContact('Title',this.value,'{!adminContact.Id}','adminContact')"/></td>
                                                        </tr>
                                                        <tr class="adminContactField">
                                                            <td class="fieldLabel"><div class="requiredLabel">Email<c:cHelp helpText="{!hMap[LOWER('Email')]}"/></div></td>
                                                        </tr>
                                                        <tr class="adminContactField">
                                                            <td><apex:inputField value="{!adminContact.Email}" onchange="updateContact('Email',this.value,'{!adminContact.Id}','adminContact')" type="email"/></td>
                                                        </tr>
                                                        <tr class="adminContactField">
                                                            <td class="fieldLabel"><div class="requiredLabel">Phone<c:cHelp helpText="{!hMap[LOWER('Phone')]}"/></div></td>
                                                        </tr>
                                                        <tr class="adminContactField">
                                                            <td><apex:inputField value="{!adminContact.Phone}" onchange="updateContact('Phone',this.value,'{!adminContact.Id}','adminContact')" type="tel"/></td>
                                                        </tr>
                                                    </table>
                                                </div>
                                                
                                            </div>  <!--  End Wrapper -->
                                            <div style="clear:both"/>
                                            
                                            <div style="width:90%">    <!-- Wrapper -->
                                                
                                                <div style="float:left;width:45%;{!if(contains(requiredContacts,'benefit'),'display:block','display:none')}">
                                                    
                                                    <div class="sectionHeader">
                                                        <apex:outputText styleclass="sectionLabel" value="Benefit Contact"/>
                                                    </div>
                                                    
                                                    
                                                    
                                                    <table class="formtable"> 
                                                        <tr>
                                                            <td class="fieldLabel"><div class="requiredLabel">Same as Admin Contact?<c:cHelp helpText="{!hMap[LOWER('ContactInfoBenefitContactSame__c')]}"/></div></td>
                                                        </tr>
                                                        <tr>
                                                            <td><apex:inputField id="benefitContactSame" value="{!cs.ContactInfoBenefitContactSame__c}" 
                                                                                 onchange="if(this.value=='Yes') {setBenefitContactToAdmin('ContactInfoBenefitContactSame__c', this.value); } else {updateCustomerSetupForm('ContactInfoBenefitContactSame__c',this.value,'benefitContact');}"/>
                                                                
                                                            </td>
                                                            
                                                        </tr>
                                                        <apex:outputPanel layout="none" rendered="{! cs.ContactInfoBenefitContactSame__c == 'No' }">
                                                        <tr>
                                                            <td class="fieldLabel" id="benefitContactLabel"><div class="requiredLabel">Benefit Contact<c:cHelp helpText="{!hMap[LOWER('ContactInfoBenefitContact__c')]}"/></div></td>
                                                        </tr>
                                                        <tr>
                                                            <td id="benefitContactInputContainer"><div class="requiredDiv" />
                                                                <!-- the "onchange" event clears the lookup field if user nullifies the contact name -->
                                                                <apex:inputField id="benefitContact" styleClass="benefitContact" value="{!cs.ContactInfoBenefitContact__c}" onchange="if(!$('[Id$=benefitContact]').val()) $('[Id$=benefitContact_lkid]').val(''); updateCustomerSetupForm('ContactInfoBenefitContact__c',$('[Id$=benefitContact_lkid]').val(),'benefitContact')"/>
                                                                &nbsp; <a class="benefitContact" href="#" onclick="$('#newContact').dialog('option','fieldName','benefitContact').dialog('open')" >+ New</a>
                                                            </td>
                                                        </tr>
                                                        <tr class="benefitContactField">
                                                            <td class="fieldLabel" id="benefitContactTitleLabel">Title<c:cHelp helpText="{!hMap[LOWER('Title')]}"/></td>
                                                        </tr>
                                                        <tr class="benefitContactField">
                                                            <td id="benefitContactTitleInput"><apex:inputField styleClass="benefitContact" value="{!benefitContact.Title}" onchange="updateContact('Title',this.value,'{!benefitContact.Id}','benefitContact')"/></td>
                                                        </tr>
                                                        <tr class="benefitContactField">
                                                            <td class="fieldLabel" id="benefitContactEmailLabel"><div class="requiredLabel">Email<c:cHelp helpText="{!hMap[LOWER('Email')]}"/></div></td>
                                                        </tr>
                                                        <tr class="benefitContactField">
                                                            <td id="benefitContactEmailInput">
                                                                <apex:inputField styleClass="benefitContact" value="{!benefitContact.Email}" onchange="updateContact('Email',this.value,'{!benefitContact.Id}','benefitContact')" type="email"/>
                                                            </td>
                                                        </tr>
                                                        <tr class="benefitContactField">
                                                            <td class="fieldLabel" id="benefitContactPhoneLabel"><div class="requiredLabel">Phone<c:cHelp helpText="{!hMap[LOWER('Phone')]}"/></div></td>
                                                        </tr>
                                                        <tr class="benefitContactField">
                                                            <td id="benefitContactPhoneInput">
                                                                <apex:inputField styleClass="benefitContact" value="{!benefitContact.Phone}" onchange="updateContact('Phone',this.value,'{!benefitContact.Id}','benefitContact')" type="tel"/>
                                                            </td>
                                                        </tr>
                                                        </apex:outputPanel>
                                                    </table>
                                                </div>
                                                
                                                
                                                <div style="float:left; width:45%;{!if(contains(requiredContacts,'billing'),'display:block','display:none')}">
                                                    
                                                    <div class="sectionHeader">
                                                        <apex:outputText styleclass="sectionLabel" value="Billing Contact"/>
                                                    </div>
                                                    
                                                    <table  class="formtable">
                                                        <tr>
                                                            <td class="fieldLabel"><div class="requiredLabel">Same as Admin Contact?<c:cHelp helpText="{!hMap[LOWER('ContactInfoBillingContactSame__c')]}"/></div></td>
                                                        </tr>
                                                        <tr>
                                                            <td><apex:inputField id="billingContactSame" value="{!cs.ContactInfoBillingContactSame__c}" 
                                                                                 onchange="if(this.value=='Yes') {setBillingContactToAdmin('ContactInfoBillingContactSame__c', this.value); } else  {updateCustomerSetupForm('ContactInfoBillingContactSame__c',this.value,'billingContact');}"/>
                                                                
                                                            </td>
                                                            
                                                        </tr>
                                                        <apex:outputPanel layout="none" rendered="{! cs.ContactInfoBillingContactSame__c == 'No' }">
                                                        <tr>
                                                            <td class="fieldLabel"><div class="requiredLabel">Billing Contact<c:cHelp helpText="{!hMap[LOWER('ContactInfoBillingContact__c')]}"/></div></td>
                                                        </tr>
                                                        <tr>
                                                            <td><apex:inputField id="billingContact" styleClass="billingContact" value="{!cs.ContactInfoBillingContact__c}" 
                                                                                 onchange="if(!$('[Id$=billingContact]').val()) $('[Id$=billingContact_lkid]').val(''); updateCustomerSetupForm('ContactInfoBillingContact__c',$('[Id$=billingContact_lkid]').val(),'billingContact')"/>
                                                                &nbsp; <a  class="billingContact"  href="#" onclick="$('#newContact').dialog('option','fieldName','billingContact').dialog('open')" >+ New</a></td>
                                                        </tr>
                                                        <tr class="billingContactField">
                                                            <td class="fieldLabel">Title<c:cHelp helpText="{!hMap[LOWER('Title')]}"/></td>
                                                        </tr>
                                                        <tr class="billingContactField">
                                                            <td><apex:inputField styleClass="billingContact" value="{!billingContact.Title}" onchange="updateContact('Title',this.value,'{!billingContact.Id}','billingContact')"/></td>
                                                        </tr>
                                                        <tr class="billingContactField">
                                                            <td class="fieldLabel"><div class="requiredLabel">Email<c:cHelp helpText="{!hMap[LOWER('Email')]}"/></div></td>
                                                        </tr>
                                                        <tr class="billingContactField">
                                                            <td><apex:inputField styleClass="billingContact" value="{!billingContact.Email}" onchange="updateContact('Email',this.value,'{!billingContact.Id}','billingContact')" type="email"/></td>
                                                        </tr>
                                                        <tr class="billingContactField">
                                                            <td class="fieldLabel"><div class="requiredLabel">Phone<c:cHelp helpText="{!hMap[LOWER('Phone')]}"/></div></td>
                                                        </tr>
                                                        <tr class="billingContactField">
                                                            <td><apex:inputField styleClass="billingContact" value="{!billingContact.Phone}" onchange="updateContact('Phone',this.value,'{!billingContact.Id}','billingContact')" type="tel"/></td>
                                                        </tr>
                                                        </apex:outputPanel>
                                                    </table>
                                                </div>
                                                
                                                
                                                
                                                
                                            </div>  <!--  End Wrapper -->
                                            
                                            <div style="clear:both"/>
                                            
                                            <div style="width:90%">    <!-- Wrapper -->
                                                <div style="float:left;width:45%;{!if(contains(requiredContacts,'s125'),'display:block','display:none')}">
                                                    
                                                    <div class="sectionHeader">
                                                        <apex:outputText styleclass="sectionLabel" value="Section 125 Contact"/>
                                                    </div>
                                                    <table class="formtable" >
                                                        <tr>
                                                            <td class="fieldLabel"><div class="requiredLabel">Same as Admin Contact?<c:cHelp helpText="{!hMap[LOWER('S125S125ContactSameAsAdmin__c')]}"/></div></td>
                                                        </tr>
                                                        <tr>
                                                            <td><apex:inputField id="s125ContactSame" value="{!s125.S125S125ContactSameAsAdmin__c}" 
                                                                                 onchange="if(this.value=='Yes') {setS125ContactToAdmin('S125S125ContactSameAsAdmin__c', this.value); } else {updateSection125Form('S125S125ContactSameAsAdmin__c',this.value,'s125Contact');}"/>
                                                                
                                                            </td>
                                                            
                                                        </tr>
                                                        <apex:outputPanel layout="none" rendered="{! s125.S125S125ContactSameAsAdmin__c == 'No' }">
                                                        <tr>
                                                            <td class="fieldLabel"><div class="requiredLabel">Section 125 Contact<c:cHelp helpText="{!hMap[LOWER('ContactInfoS125Contact__c')]}"/></div></td>
                                                        </tr>
                                                        <tr>
                                                            <td>
                                                                <apex:inputField id="s125Contact" styleClass="s125Contact" value="{!s125.ContactInfoS125Contact__c}" 
                                                                                 onchange="if(!$('[Id$=s125Contact]').val()) $('[Id$=s125Contact_lkid]').val(''); updateSection125Form('ContactInfoS125Contact__c',$('[Id$=s125Contact_lkid]').val(),'s125Contact')"/>
                                                                &nbsp; <a   class="s125Contact" href="#" onclick="$('#newContact').dialog('option','fieldName','s125Contact').dialog('open')" >+ New</a>
                                                            </td>
                                                        </tr>
                                                        <tr class="s125ContactField">
                                                            <td class="fieldLabel">Title<c:cHelp helpText="{!hMap[LOWER('Title')]}"/></td>
                                                        </tr>
                                                        <tr class="s125ContactField">
                                                            <td><apex:inputField styleClass="s125Contact" value="{!s125Contact.Title}" onchange="updateContact('Title',this.value,'{!s125Contact.Id}','s125Contact')"/></td>
                                                        </tr>
                                                        <tr class="s125ContactField">
                                                            <td class="fieldLabel"><div class="requiredLabel">Email<c:cHelp helpText="{!hMap[LOWER('Email')]}"/></div></td>
                                                        </tr>
                                                        <tr class="s125ContactField">
                                                            <td>
                                                                <apex:inputField styleClass="s125Contact" value="{!s125Contact.Email}" onchange="updateContact('Email',this.value,'{!s125Contact.Id}','s125Contact')" type="email"/>
                                                            </td>
                                                        </tr>
                                                        <tr class="s125ContactField">
                                                            <td class="fieldLabel"><div class="requiredLabel">Phone<c:cHelp helpText="{!hMap[LOWER('Phone')]}"/></div></td>
                                                        </tr>
                                                        <tr class="s125ContactField">
                                                            <td>
                                                                <apex:inputField styleClass="s125Contact" value="{!s125Contact.Phone}" onchange="updateContact('Phone',this.value,'{!s125Contact.Id}','s125Contact')" type="tel"/>
                                                            </td>
                                                        </tr>
                                                        </apex:outputPanel>
                                                    </table>
                                                </div>
                                                
                                                
                                                
                                                <div style="float:left; width:45%;{!if(contains(requiredContacts,'flex'),'display:block','display:none')}">
                                                    
                                                    
                                                    <div class="sectionHeader">
                                                        <apex:outputText styleclass="sectionLabel" value="Flex Contact"/>
                                                    </div>
                                                    
                                                    <table class="formtable" >
                                                        <tr>
                                                            <td class="fieldLabel"><div class="requiredLabel">Same as Admin Contact?<c:cHelp helpText="{!hMap[LOWER('S125FlexContactSameAsAdmin__c')]}"/></div></td>
                                                        </tr>
                                                        <tr>
                                                            <td><apex:inputField id="flexContactSame" value="{!s125.S125FlexContactSameAsAdmin__c}" 
                                                                                 onchange="if(this.value=='Yes') {setFlexContactToAdmin('S125FlexContactSameAsAdmin__c', this.value); } else {updateSection125Form('S125FlexContactSameAsAdmin__c',this.value,'flexContact');}"/>
                                                            </td>
                                                            
                                                        </tr>
                                                        <apex:outputPanel layout="none" rendered="{! s125.S125FlexContactSameAsAdmin__c == 'No' }">
                                                        <tr>
                                                            <td class="fieldLabel"><div class="requiredLabel">Flex Contact<c:cHelp helpText="{!hMap[LOWER('ContactInfoFlexContact__c')]}"/></div></td>
                                                        </tr>
                                                        <tr>
                                                            <td>
                                                                <apex:inputField id="flexContact" styleClass="flexContact" value="{!s125.ContactInfoFlexContact__c}" 
                                                                                 onchange="if(!$('[Id$=flexContact]').val()) $('[Id$=flexContact_lkid]').val(''); updateSection125Form('ContactInfoFlexContact__c',$('[Id$=flexContact_lkid]').val(),'flexContact')"/>
                                                                &nbsp; <a   class="flexContact" href="#" onclick="$('#newContact').dialog('option','fieldName','flexContact').dialog('open')" >+ New</a>
                                                            </td>
                                                        </tr>
                                                        <tr class="flexContactField">
                                                            <td class="fieldLabel">Title<c:cHelp helpText="{!hMap[LOWER('Title')]}"/></td>
                                                        </tr>
                                                        <tr class="flexContactField">
                                                            <td><apex:inputField styleClass="flexContact" value="{!flexContact.Title}" onchange="updateContact('Title',this.value,'{!flexContact.Id}','flexContact')"/></td>
                                                        </tr>
                                                        <tr class="flexContactField">
                                                            <td class="fieldLabel"><div class="requiredLabel">Email<c:cHelp helpText="{!hMap[LOWER('Email')]}"/></div></td>
                                                        </tr>
                                                        <tr class="flexContactField">
                                                            <td>
                                                                <apex:inputField styleClass="flexContact" value="{!flexContact.Email}" onchange="updateContact('Email',this.value,'{!flexContact.Id}','flexContact')" type="email"/>
                                                            </td>
                                                        </tr>
                                                        <tr class="flexContactField">
                                                            <td class="fieldLabel"><div class="requiredLabel">Phone<c:cHelp helpText="{!hMap[LOWER('Phone')]}"/></div></td>
                                                        </tr>
                                                        <tr class="flexContactField">
                                                            <td><div class="requiredDiv" />
                                                                <apex:inputField styleClass="flexContact" value="{!flexContact.Phone}" onchange="updateContact('Phone',this.value,'{!flexContact.Id}','flexContact')" type="tel"/>
                                                            </td>
                                                        </tr>
                                                        </apex:outputPanel>
                                                    </table>
                                                </div>
                                                
                                                
                                                
                                            </div>  <!--  End Wrapper -->
                                            <div style="clear:both"/>
                                            
                                            <div style="width:90%">    <!-- Wrapper -->
                                                
                                                <div style="float:left;width:45%;{!if(contains(requiredContacts,'annuity'),'display:block','display:none')}">
                                                    
                                                    <div class="sectionHeader">
                                                        <apex:outputText styleclass="sectionLabel" value="Annuity Contact"/>
                                                    </div>
                                                    
                                                    <table  class="formtable">
                                                        <tr>
                                                            <td class="fieldLabel"><div class="requiredLabel">Same as Admin Contact?<c:cHelp helpText="{!hMap[LOWER('AnnBeforeTaxContInfoSameAdminContact__c')]}"/></div></td>
                                                        </tr>
                                                        <tr>
                                                            <td><apex:inputField id="annuityContactSame" value="{!cs.AnnBeforeTaxContInfoSameAdminContact__c}" 
                                                                                 onchange="if(this.value=='Yes') {setAnnuityContactToAdmin('AnnBeforeTaxContInfoSameAdminContact__c', this.value); } else  {updateCustomerSetupForm('AnnBeforeTaxContInfoSameAdminContact__c',this.value,'annuityContact');}"/>
                                                                
                                                            </td>
                                                            
                                                        </tr>
                                                        <apex:outputPanel layout="none" rendered="{! cs.AnnBeforeTaxContInfoSameAdminContact__c == 'No' }">
                                                        <tr>
                                                            <td class="fieldLabel"><div class="requiredLabel">Annuity Contact<c:cHelp helpText="{!hMap[LOWER('Annuity_Contact__c')]}"/></div></td>
                                                        </tr>
                                                        <tr>
                                                            <td><apex:inputField id="annuityContact" styleClass="annuityContact" value="{!cs.Annuity_Contact__c}" 
                                                                                 onchange="if(!$('[Id$=annuityContact').val()) $('[Id$=annuityContact_lkid]').val(''); updateCustomerSetupForm('Annuity_Contact__c',$('[Id$=annuityContact_lkid]').val(),'annuityContact')"/>
                                                                &nbsp; <a  class="annuityContact"  href="#" onclick="$('#newContact').dialog('option','fieldName','annuityContact').dialog('open')" >+ New</a></td>
                                                        </tr>
                                                        <tr class="annuityContactField">
                                                            <td class="fieldLabel">Title<c:cHelp helpText="{!hMap[LOWER('Title')]}"/></td>
                                                        </tr>
                                                        <tr class="annuityContactField">
                                                            <td><apex:inputField styleClass="annuityContact" value="{!annuityContact.Title}" onchange="updateContact('Title',this.value,'{!annuityContact.Id}','annuityContact')"/></td>
                                                        </tr>
                                                        <tr class="annuityContactField">
                                                            <td class="fieldLabel"><div class="requiredLabel">Email<c:cHelp helpText="{!hMap[LOWER('Email')]}"/></div></td>
                                                        </tr>
                                                        <tr class="annuityContactField">
                                                            <td><apex:inputField styleClass="annuityContact" value="{!annuityContact.Email}" onchange="updateContact('Email',this.value,'{!annuityContact.Id}','annuityContact')" type="email"/></td>
                                                        </tr>
                                                        <tr class="annuityContactField">
                                                            <td class="fieldLabel"><div class="requiredLabel">Phone<c:cHelp helpText="{!hMap[LOWER('Phone')]}"/></div></td>
                                                        </tr>
                                                        <tr class="annuityContactField">
                                                            <td><apex:inputField styleClass="annuityContact" value="{!annuityContact.Phone}" onchange="updateContact('Phone',this.value,'{!annuityContact.Id}','annuityContact')" type="tel"/></td>
                                                        </tr>
                                                        </apex:outputPanel>
                                                    </table>
                                                </div>
                                                
                                                <div style="float:left;width:45%;{!if(contains(requiredContacts,'hsa'),'display:block','display:none')}">
                                                    
                                                    <div class="sectionHeader">
                                                        <apex:outputText styleclass="sectionLabel" value="HSA Contact"/>
                                                    </div>
                                                    
                                                    <table  class="formtable">
                                                        <tr>
                                                            <td class="fieldLabel"><div class="requiredLabel">Same as Admin Contact?<c:cHelp helpText="{!hMap[LOWER('HlthSvgsAcctIsHSAcontactsameasAdmin__c')]}"/></div></td>
                                                        </tr>
                                                        <tr>
                                                            <td><apex:inputField id="hsaContactSame" value="{!s125.HlthSvgsAcctIsHSAcontactsameasAdmin__c}" 
                                                                                 onchange="if(this.value=='Yes') {setHSAContactToAdmin('HlthSvgsAcctIsHSAcontactsameasAdmin__c', this.value); } else  {updateSection125Form('HlthSvgsAcctIsHSAcontactsameasAdmin__c',this.value,'hsaContact');}"/>
                                                                
                                                            </td>
                                                            
                                                        </tr>
                                                        <apex:outputPanel layout="none" rendered="{! s125.HlthSvgsAcctIsHSAcontactsameasAdmin__c == 'No' }">
                                                        <tr>
                                                            <td class="fieldLabel"><div class="requiredLabel">HSA Contact<c:cHelp helpText="{!hMap[LOWER('HlthSvgsAcctEligReq__c')]}"/></div></td>
                                                        </tr>
                                                        <tr>
                                                            <td><apex:inputField id="hsaContact" styleClass="hsaContact" value="{!s125.HlthSvgsAcctEligReq__c}" 
                                                                                 onchange="if(!$('[Id$=hsaContact').val()) $('[Id$=hsaContact_lkid]').val(''); updateSection125Form('HlthSvgsAcctEligReq__c',$('[Id$=hsaContact_lkid]').val(),'hsaContact')"/>
                                                                &nbsp; <a  class="hsaContact"  href="#" onclick="$('#newContact').dialog('option','fieldName','hsaContact').dialog('open')" >+ New</a></td>
                                                        </tr>
                                                        <tr class="hsaContactField">
                                                            <td class="fieldLabel">Title<c:cHelp helpText="{!hMap[LOWER('Title')]}"/></td>
                                                        </tr>
                                                        <tr class="hsaContactField">
                                                            <td><apex:inputField styleClass="hsaContact" value="{!hsaContact.Title}" onchange="updateContact('Title',this.value,'{!hsaContact.Id}','hsaContact')"/></td>
                                                        </tr>
                                                        <tr class="hsaContactField">
                                                            <td class="fieldLabel"><div class="requiredLabel">Email<c:cHelp helpText="{!hMap[LOWER('Email')]}"/></div></td>
                                                        </tr>
                                                        <tr class="hsaContactField">
                                                            <td><apex:inputField styleClass="hsaContact" value="{!hsaContact.Email}" onchange="updateContact('Email',this.value,'{!hsaContact.Id}','hsaContact')" type="email"/></td>
                                                        </tr>
                                                        <tr class="hsaContactField">
                                                            <td class="fieldLabel"><div class="requiredLabel">Phone<c:cHelp helpText="{!hMap[LOWER('Phone')]}"/></div></td>
                                                        </tr>
                                                        <tr class="hsaContactField">
                                                            <td><apex:inputField styleClass="hsaContact" value="{!hsaContact.Phone}" onchange="updateContact('Phone',this.value,'{!hsaContact.Id}','hsaContact')" type="tel"/></td>
                                                        </tr>
                                                        </apex:outputPanel>
                                                    </table>
                                                </div>
                                                
                                                
                                            </div>  <!--  End Wrapper -->
                                            <div style="clear:both"/>
                                            
                                            
                                            
                                            
                                            
                                            <div id="newContact" style="display:none">
                                                <table class="formtable">
                                                    <tr>
                                                        <td class="fieldLabel"><div class="requiredLabel">First Name</div></td>
                                                    </tr>
                                                    <tr>
                                                        <td><input id="newContactFirstName" type="text"/></td>
                                                    </tr>
                                                    <tr>
                                                        <td class="fieldLabel"><div class="requiredLabel">Last Name</div></td>
                                                    </tr>
                                                    <tr>
                                                        <td><input id="newContactLastName" type="text"/></td>
                                                    </tr>
                                                    <tr>
                                                        <td class="fieldLabel"><div class="requiredLabel">Title</div></td>
                                                    </tr>
                                                    <tr>
                                                        <td><input id="newContactTitle" type="text"/></td>
                                                    </tr>
                                                    <tr>
                                                        <td class="fieldLabel"><div class="requiredLabel">Email</div></td>
                                                    </tr>
                                                    <tr>
                                                        <td><input id="newContactEmail" type="email"/></td>
                                                    </tr>
                                                    <tr>
                                                        <td class="fieldLabel">Phone</td>
                                                    </tr>
                                                    <tr>
                                                        <td><input id="newContactPhone" type="tel"/></td>
                                                    </tr>
                                                    <tr>
                                                        <td class="fieldLabel">Ext</td>
                                                    </tr>
                                                    <tr>
                                                        <td><input id="newContactExt" type="text" class="numeric"/></td>
                                                    </tr>
                                                </table>
                                                
                                                <div style="font-size:11px;font-weight:bold;margin-top:10px">
                                                    <p>Complete all required fields and press Ok to create new Contact for this Account.</p>
                                                </div>
                                                
                                            </div>
                                            
                                            <div id="createEnrollmentEvent" style="display:none">
                                                <table class="formtable">
                                                    <tr>
                                                        <td class="fieldLabel">{! $ObjectType.Event.Fields.Type__c.Label}<c:cHelp helpText="{!hMap[LOWER('Type__c')]}"/></td>
                                                    </tr>
                                                    <tr>
                                                        <td><apex:inputfield value="{!enrollmentEvent.Type__c}" html-disabled="disabled" /></td>
                                                    </tr>
                                                    <tr>
                                                        <td class="fieldLabel"><div class="requiredLabel">{! $ObjectType.Event.Fields.Sub_Type__c.Label}<c:cHelp helpText="{!hMap[LOWER('Sub_Type__c')]}"/></div></td>
                                                    </tr>
                                                    <tr>
                                                        <td><apex:inputField id="dialogSubtype" value="{!enrollmentEvent.Sub_Type__c}" /></td>
                                                    </tr>
                                                    <tr>
                                                        <td class="fieldLabel">All Day Event<c:cHelp helpText="{!hMap[LOWER('IsAllDayEvent')]}"/></td>
                                                    </tr>
                                                    <tr>
                                                        <td><apex:inputField value="{!enrollmentEvent.IsAllDayEvent}" /></td>
                                                    </tr>
                                                    <tr>
                                                        <td class="fieldLabel"><div class="requiredLabel">Start Date/Time</div></td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <input id="dialogStartDate" type="datetime-local"/>
                                                        </td>
                                                    </tr>
                                                    
                                                    <tr>
                                                        <td class="fieldLabel"><div class="requiredLabel">End Date/Time</div></td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <input id="dialogEndDate" type="datetime-local"/>
                                                        </td>
                                                    </tr>
                                                    
                                                    
                                                </table>
                                                
                                                <div style="font-size:11px;font-weight:bold;margin-top:10px">
                                                    <p>Complete all required fields and press Ok to create the Enrollment Event.</p>
                                                    <p>
                                                        Any enrollment event longer than 14 days will require creating a recurring event. 
                                                        To create a Recurring Event click the link below.
                                                    </p>
                                                </div>
                                                
                                            </div>
                                            
                                            <c:UnlockRequest efId="{! If(EF != null, EF.Id, null) }" />
                                            <c:CustomMultiSelectPicklist fieldsToReplace="residenceStates,enrollmentDetailsField" />
                                            
                                            <script>
                                            // script needs to rerun when panel is rerendered
                                            
                                            // setup numeric plugin
                                            $("input.numeric3").numeric(",");      
                                            $("input.numeric").numeric();    
                                            
                                            // show required field indicators  
                                            $('.requiredLabel').css('visibility' , 'visible');
                                            
                                            // get rid of error messages
                                            $('[Id$=page]').click(function() {
                                                $('#submitMessage').empty();
                                                $("#submitMessage").hide();
                                            });          
                                            
                                            //$("#scrollable").css("height", window.innerHeight - 210);
                                            //console.log('*** height: ' +window.innerHeight);
                                            
                                            /********************************** hide/show Contact details **********************/
                                            // if Contact Lookup fields are null, their related fields should not be shown
                                            if(!'{!eOppty.Administrative_Contact__c}') 
                                                $('.adminContactField').hide();
                                            else
                                                $('.adminContactField').show();
                                            
                                            if(!'{!cs.ContactInfoBenefitContact__c}') 
                                                $('.benefitContactField').hide();
                                            else
                                                $('.benefitContactField').show();
                                            
                                            if(!'{!cs.ContactInfoBillingContact__c}') 
                                                $('.billingContactField').hide();
                                            else
                                                $('.billingContactField').show();
                                            
                                            if(!'{!s125.ContactInfoS125Contact__c}') 
                                                $('.s125ContactField').hide();
                                            else
                                                $('.s125ContactField').show();
                                            
                                            if(!'{!s125.ContactInfoFlexContact__c}') 
                                                $('.flexContactField').hide();
                                            else
                                                $('.flexContactField').show();
                                            
                                            if(!'{!cs.Annuity_Contact__c}') 
                                                $('.annuityContactField').hide();
                                            else
                                                $('.annuityContactField').show();
                                                
                                            if(!'{!s125.HlthSvgsAcctEligReq__c}')
                                                $('.hsaContactField').hide();
                                            else
                                                $('.hsaContactField').show();
                                                
                                            togglePayrollUploadDueDateVisibility()
                                            
                                            
                                            /*>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>*/
                                            
                                            //Status Indicator
                                            if ({!!formIsSubmitted})
                                                $("#status").attr("style", "color:red;");
                                            else
                                                $("#status").attr("style", "color:#0B0;");
                                            
                                            //$("body .bPageBlock, body #bodyCell .bResource .secondaryPalette, body .secondaryPalette.bPageBlock, body .individualPalette .secondaryPalette.bPageBlock, body .bodyDiv .genericTable, body .genericPageBlockTable, body .bodyDiv .bSubBlock, body .bComponentBlock .bPageBlock, body .bMyDashboard .bPageBlock, body.rlHoverFrame .bPageBlock, body.subjectSelectionPopup div.choicesBox, body.lookupTab .secondaryPalette.bPageBlock, body.popupTab .secondaryPalette.bPageBlock, body.UserTagStatsPage .secondaryPalette.bPageBlock").css("color", "#54698D");
                                            setFormColor("color", "#54698D");  //dk blue 
                                            
                                            setupPopover();  //Help for Service Process field
                                            
                                            replacePicklists({!formIsSubmitted && IsUnlocked == false});
                                            
                                            //When form has been submitted, lock down form - allow no changes
                                            if ({!formIsSubmitted && IsUnlocked == false})
                                            { 
                                                setFormColor("background-color","#EAECEC");
                                                $('.af-header').addClass('af-header-submitted');
                                                $('html').css('background-color', '#EAECEC');
                                                
                                                $('input[type=button]').each(function() {
                                                    $(this).attr({
                                                        'disabled': 'disabled'
                                                    });
                                                });
                                                
                                                
                                                /* jhicks 10/2016 removed comment here */
                                                $('select').each(function() {
                                                    $(this).attr({
                                                        'disabled': 'disabled'
                                                    });
                                                });
                                                
                                                $('textarea').each(function() {
                                                    $(this).attr({
                                                        'disabled': 'disabled'
                                                    });
                                                });
                                                
                                                $('input').each(function() {
                                                    $(this).attr({
                                                        'disabled': 'disabled'
                                                    });
                                                });
                                                
                                                $('.requiredLabel').toggleClass('noshow');
                                                
                                                if ({!!formRequestToEdit && ef.Platform_Setup_Status__c = 'In Progress'}){
                                                    $('#requestEdit').show();
                                                    $('#requestEdit').prop('disabled',false);
                                                }
                                                
                                                if ({!!formRequestToEdit && ef.Platform_Setup_Status__c != 'In Progress'}){
                                                    $('#requestEditText').show();
                                                }
                                                
                                                $('td.multiSelectPicklistCell').find('img').css('display','none');
                                                $('.removeProduct').css('display','none');
                                                
                                                // disable Contact fields, links, lookupIcon form is Confirmed
                                                disableContactFields('.benefitContact', 'Yes');
                                                disableContactFields('.billingContact', 'Yes');
                                                disableContactFields('.annuityContact', 'Yes');
                                                disableContactFields('.s125Contact',  'Yes');
                                                disableContactFields('.flexContact', 'Yes');
                                                disableContactFields('.adminContact', 'Yes');
                                                disableContactFields('.hsaContact', 'Yes');
                                                
                                                $('.leaveUnlocked').prop('disabled', false);
                                                $('[Id$=otm]').prop('disabled',false);
                                                
                                                if ({! $Permission.Unlock_Setup_Forms }) {
                                                    $('#unlockBtn').show();
                                                    $('#unlockBtn').prop('disabled',false);
                                                }
                                            }  
                                            // jhicks
                                            else {
                                                $('.requiredLabel').css('visibility' , 'visible');
                                                
                                                if ({! !formIsSubmitted}) {
                                                    $('#confirmButtonGen').show();
                                                }

                                                setFormColor("background-color","white");
                                                $('.af-header').removeClass('af-header-submitted');
                                                $('html').css('background-color', 'white');
                                                
                                                // disable Contact fields when same as Admin Contact
                                                disableContactFields('.benefitContact', $('[Id$=benefitContactSame]').val());
                                                disableContactFields('.billingContact', $('[Id$=billingContactSame]').val());
                                                disableContactFields('.annuityContact', $('[Id$=annuityContactSame]').val());
                                                disableContactFields('.s125Contact', $('[Id$=s125ContactSame]').val());
                                                disableContactFields('.flexContact', $('[Id$=flexContactSame]').val());
                                                disableContactFields('.hsaContact', $('[Id$=hsaContactSame]').val());
                                                
                                            }
                                            
                                            if ({! formIsSubmitted && IsUnlocked }) {
                                                $('#lockBtn').show();
                                            }
                                            
                                            
                                            $('.messageText').css('font-size','12px');
                                            
                                            if ({! NumberExistingMarketedProducts == 0 }) {
                                                $('#selectProductsBtn').click();
                                            }
                                            
                                            function togglePayrollUploadDueDateVisibility() {
                                                if ({!ps.Enroll_Info_Upload__c=='Yes'}) {
                                                    showPayrollFileUploadDueDate();
                                                }
                                                else {
                                                    hidePayrollFileUploadDueDate();
                                                }
                                            }
                                            
                                            function disableContactFields(contactClass, disable) {
                                                
                                                if (disable=='Yes') {
                                                    $(contactClass).prop('disabled', true);                             // disable fields
                                                    $(contactClass).siblings("img").css('visibility', 'hidden');        // hide lookupIcon
                                                    $('a'+contactClass ).css('visibility','hidden');   // hide "+ New" anchor
                                                    //console.log('*** Class / Disabled: ' + contactClass + ' / ' + disable);
                                                }
                                                else{
                                                    $(contactClass).prop('disabled',false);
                                                    $(contactClass).siblings("img").css('visibility', 'visible');      
                                                    $('a'+contactClass ).css('visibility','visible');
                                                    //console.log('*** Class / Disabled: ' + contactClass + ' / ' + disable);
                                                }
                                            }
                                            
                                            $("#newContact").dialog({
                                                autoOpen: false,
                                                resizable: false,
                                                closeOnEscape: false,
                                                height:500,
                                                width:350,
                                                modal: true,
                                                title: "Create New Contact",
                                                position: {my: "center", at: "center", of: window},
                                                classes: {
                                                    "ui-dialog" : "dialogFixed",
                                                    "ui-dialog-titlebar-close" : "dialogInvisible",
                                                    "ui-dialog-titlebar" : "dialogTitle"
                                                },        
                                                open: function() {
                                                    
                                                    $('.ui-dialog-buttonpane').find('button:contains("Ok")').addClass('gbtn');
                                                    $('.ui-dialog-buttonpane').find('button:contains("Cancel")').addClass('gbtn');
                                                    $("#newContactExt").numeric(",");
                                                },
                                                buttons: [ {
                                                    text: "Ok",
                                                    classes:{"ui-button" : "highlight"},
                                                    click: function() {
                                                        if ($('#newContactFirstName').val()!='' && $('#newContactLastName').val()!='' && $('#newContactEmail').val()!='') {
                                                            $(this).dialog("close");
                                                            var fieldName = $(this).dialog("option","fieldName");
                                                            createNewContact(fieldName, $('#newContactFirstName').val(),$('#newContactLastName').val(),$('#newContactTitle').val(),
                                                                             $('#newContactEmail').val(),$('#newContactPhone').val(),$('#newContactExt').val());
                                                        }
                                                    }
                                                },
                                                          {
                                                              text: "Cancel", 
                                                              click: function() {
                                                                  $(this).dialog("close");
                                                              }
                                                          }]
                                            });
                                            
                                            $("#createEnrollmentEvent").dialog({
                                                autoOpen: false,
                                                resizable: false,
                                                closeOnEscape: false,
                                                height:500,
                                                width:450,
                                                modal: true,
                                                title: "Create Enrollment Event",
                                                position: {my: "top center", at: "top center", of: window},
                                                classes: {
                                                    "ui-dialog" : "dialogFixed",
                                                    "ui-dialog-titlebar-close" : "dialogInvisible",
                                                    "ui-dialog-titlebar" : "dialogTitle"
                                                },        
                                                open: function() {
                                                    $(this).parent().appendTo($("[Id$=theForm]"));   // this to keep dialog inside Form tag to work with SF properly
                                                    
                                                    // get start/end dates from browser
                                                    try{
                                                        var start = new Date($('[id$=enrollmentStartDate]').val()).toISOString().slice(0,10) + 'T00:00';  //transforms to YYYY-MM-DDT00:00
                                                        var end = new Date($('[id$=enrollmentEndDate]').val()).toISOString().slice(0,10) + 'T00:00';
                                                    }
                                                    catch(err) {
                                                        alert('Error determining Start/End date.  Please check Enrollment Start and End Dates.');
                                                        $(this).dialog("close");
                                                    }         
                                                    $('#dialogStartDate').val(start);
                                                    $('#dialogEndDate').val(end);
                                                    
                                                    $('.ui-dialog-buttonpane').find('button:contains("Save")').addClass('gbtn');
                                                    $('.ui-dialog-buttonpane').find('button:contains("Cancel")').addClass('gbtn');
                                                    $('.ui-dialog-buttonpane').find('button:contains("Recurring")').addClass('buttonAsLink');
                                                    
                                                },
                                                buttons: [ {
                                                    text: "Save",
                                                    click: function() {
                                                        createEnrollmentEvent('No')
                                                    }
                                                },
                                                          {
                                                              text: "Cancel", 
                                                              click: function() {
                                                                  $(this).dialog("close");
                                                                  //$(this).parent().appendTo($("[Id$=theForm]"));
                                                              }
                                                          },
                                                          {
                                                              text: "Create Recurring Event/Invite Others", 
                                                              click: function() {
                                                                  createEnrollmentEvent('Yes');
                                                                  // $(this).parent().appendTo($("[Id$=theForm]"));
                                                              }
                                                          }
                                                          
                                                         ]
                                            }); 
                                            
                                            function createEnrollmentEvent(navigate) {
                                                
                                                if($('[id$=dialogSubtype]').val().length == 0 || $('#dialogStartDate').val() == '' || $('#dialogEndDate').val() == '' ) 
                                                    return;
                                                
                                                createEnrollmentEvent2( $('#dialogStartDate').val() , $('#dialogEndDate').val(), navigate);
                                                $("#createEnrollmentEvent").dialog('close');
                                            }
                                            
                                            function submitForm() {
                                                console.log('**** reached js submitForm');
                                                if ({!!detailsTabComplete}) {
                                                    $('#detailsTabLink').click();
                                                    document.getElementById("submitMessage").innerHTML = "Confirm Failed. Check all required fields.";
                                                    $("#submitMessage").show();
                                                }
                                                else if ({!!productTabComplete}) {
                                                    $('#marketedTabLink').click();
                                                    document.getElementById("submitMessage").innerHTML = "Confirm Failed. Check all required fields.";
                                                    $("#submitMessage").show();
                                                }
                                                    else if ({!!enrollmentTabComplete}) {
                                                        $('#enrollmentTeamTabLink').click();
                                                        document.getElementById("submitMessage").innerHTML = "Confirm Failed. Check all required fields.";
                                                        $("#submitMessage").show();
                                                    }
                                                        else {
                                                            console.log('**** calling Controller to submitForm');
                                                            submitFormCTRL();   
                                                        }     
                                            }
                                            
                                            function setFormColor(attr,color) {
                                                $("body .bPageBlock, body #bodyCell .bResource .secondaryPalette, body .secondaryPalette.bPageBlock, body .individualPalette .secondaryPalette.bPageBlock," +
                                                  "body .bodyDiv .genericTable, body .genericPageBlockTable, body .bodyDiv .bSubBlock, body .bComponentBlock .bPageBlock, body .bMyDashboard .bPageBlock," + 
                                                  " body.rlHoverFrame .bPageBlock, body.subjectSelectionPopup div.choicesBox, body.lookupTab .secondaryPalette.bPageBlock, body.popupTab .secondaryPalette.bPageBlock, body.UserTagStatsPage .secondaryPalette.bPageBlock")
                                                .css(attr, color);
                                            }
                                            
                                            /*>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>*/
                                            
                                            function addProductCallback(addProductError) {
                                                if (addProductError) {
                                                    document.getElementById("submitMessage").innerHTML = "Add Products Failed. Check all required fields." + '{! addProductErrorMessage }';
                                                    $("#submitMessage").show();
                                                    $('#marketedProducts').hide();
                                                    $('#productCatalog').show();
                                                }
                                                else {
                                                    // reload page
                                                    var url='/apex/GeneralInformation?id={!eOppty.Id}&clickProductsTab=1';
                                                    openForm(url);
                                                }
                                            }
                                            
                                            
                                            /**********************************************************/
                                            
                                            var openForm = function(url){
                                                
                                                console.log('**** opening url: ' + url);
                                                if(typeof sforce !== "undefined" && sforce !== null) {
                                                    // Salesforce1 navigation
                                                    sforce.one.navigateToURL(url, true);
                                                } else {
                                                    // Desktop navigation
                                                    window.open(url, '_self'); 
                                                }
                                            }   
                                            
                                            /*>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>*/
                                            //Save record if form is not submitted
                                            
                                            var saveRecord = function()
                                            {
                                                
                                                saveRecord2();
                                                
                                            }      
                                            
                                            /*>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>*/
                                            var saveRecordandRerenderPlatform = function()
                                            {
                                                
                                                saveRecordandRerenderPlatform2();
                                                
                                            }      
                                            
                                            
                                            /*>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>*/
                                            
                                            function togglePhysicalAddressVisibility(value) {
                                                var StreetString = '[name*=":AccountShippingStreet"]';
                                                var CityString = '[name*=":AccountShippingCity"]';
                                                var StateString = '[name*=":AccountShippingState"]';
                                                var ZipString = '[name*=":AccountShippingPostalCode"]';
                                                
                                                $('#physicalStreet').hide();
                                                $('#physicalCity').hide();
                                                $('#physicalState').hide();
                                                $('#physicalZip').hide();
                                                $(StreetString).hide();
                                                $(CityString).hide();
                                                $(StateString).hide();
                                                $(ZipString).hide();
                                                

                                                if (value == 'No') {
                                                    $('#physicalStreet').show();
                                                    $('#physicalCity').show();
                                                    $('#physicalState').show();
                                                    $('#physicalZip').show();
                                                    $(StreetString).show();
                                                    $(CityString).show();
                                                    $(StateString).show();
                                                    $(ZipString).show();
                                                }
                                                
                                            }
                                            
                                            var SetPhysicalAddress = function(value)
                                            {
                                                console.log('*** Physical Same as set to: ' + value);
                                                var billingStreet = '[name*=":AccountBillingStreet"]';
                                                var billingCity = '[name*=":AccountBillingCity"]';
                                                var billingState = '[name*=":AccountBillingState"]';
                                                var billingZip = '[name*=":AccountBillingPostalCode"]';
                                                
                                                var addyStreet = $(billingStreet).val();
                                                var addyCity = $(billingCity).val();
                                                var addyState = $(billingState).val();
                                                var addyZip = $(billingZip).val(); 
                                                
                                                var StreetString = '[name*=":AccountShippingStreet"]';
                                                var CityString = '[name*=":AccountShippingCity"]';
                                                var StateString = '[name*=":AccountShippingState"]';
                                                var ZipString = '[name*=":AccountShippingPostalCode"]';
                                                
                                                if (value == 'Yes'){
                                                    
                                                    $(StreetString).val(addyStreet);
                                                    updateAccountField('{!acc.Id}', 'ShippingStreet', addyStreet);
                                                    $(CityString).val(addyCity);
                                                    updateAccountField('{!acc.Id}', 'ShippingCity', addyCity);                    
                                                    $(StateString).val(addyState);
                                                    updateAccountField('{!acc.Id}', 'ShippingState', addyState);                    
                                                    $(ZipString).val(addyZip);
                                                    updateAccountField('{!acc.Id}', 'ShippingPostalCode', addyZip);                    
                                                    $(StreetString).prop('disabled', true);
                                                    $(CityString).prop('disabled', true);
                                                    $(StateString).prop('disabled', true);
                                                    $(ZipString).prop('disabled', true);
                                                }
                                                else if(value == 'No')
                                                {
                                                    $(StreetString).val("");
                                                    updateAccountField('{!acc.Id}', 'ShippingStreet', "");
                                                    $(CityString).val("");
                                                    updateAccountField('{!acc.Id}', 'ShippingCity', "");
                                                    $(StateString).val("");
                                                    updateAccountField('{!acc.Id}', 'ShippingState', "");
                                                    $(ZipString).val("");
                                                    updateAccountField('{!acc.Id}', 'ShippingPostalCode', ""); 
                                                    $(StreetString).prop('disabled', false);
                                                    $(CityString).prop('disabled', false);
                                                    $(StateString).prop('disabled', false);
                                                    $(ZipString).prop('disabled', false);
                                                }
                                                
                                                updateEnrollmentOpportunity();
                                            }
                                            
                                            /*>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>*/
                                            var submitdone = function()
                                            {
                                                document.getElementById("submitMessage").innerHTML = "Confirm Complete";
                                                $("#submitMessage").show();
                                            }
                                            
                                            
                                            /*>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>*/
                                            var updateAccountField = function(acctId, name, value)
                                            {
                                                updateAccountField2(acctId, name, value);
                                            }
                                            /*>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>*/
                                            var updatePlatformSetup = function(name, value)
                                            {
                                                console.log('**** value: ' + value);
                                                updatePlatformSetup2(name, value);
                                            }
                                            /*>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>*/
                                            var updateProduct = function(id, name, value)
                                            {
                                                if (name == 'Plan_Status__c')
                                                    updateProductAndReload(id, name, value);
                                                else    
                                                    updateProduct2(id, name, value);
                                            }
                                            /*>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>*/
                                            
                                            function updatePlatformSetupFromMulti(name, elem)
                                            {
                                                var select = document.getElementById(elem.id);
                                                var selected = '';
                                                for (var i = 0; i < select.length; i++) {
                                                    if (select.options[i].selected){
                                                        selected += (select.options[i].value)+';';
                                                        console.log('+++ item: ' + select.options[i].value);
                                                    }
                                                }
                                                updatePlatformSetup(name, selected);
                                            }
                                            
                                            /*>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>*/
                                            function setupPopover() {
                                                
                                                $('#serviceProcessHelp').popover({
                                                    html: true,
                                                    trigger: "click hover",
                                                    placement: "top",
                                                    title: 'Service Process Help',
                                                    content : "<b>Account Manager Controlled:</b>&nbsp; An Account Manager-Controlled enrollment is one that an Account Manager(s)will be conducting all of the enrollments via one-on-one and the enrollees will NOT be entering information in the enrollment system." +
                                                    "<br/><br/><b>Self-Service:</b>&nbsp;In a Self Service enrollment the enrollee will be given site access via log-in instructions will be able to conduct their enrollment on their own at the location of their choosing (i.e. home, at employer, internet cafe, etc" +
                                                    "<br/><br/><b>Hybrid</b>&nbsp;A hybrid enrollment is one in which the employees can either enroll on their own with their personal login, or can enroll with an Account Manager(s) one on one.  Employees that enrolled with Account Manager(s) can also make changes to<br/>their enrollment choices at a later date than if they enroll on their own."
                                                    
                                                });  
                                                
                                                // setup close popover
                                                $('#serviceProcessHelp').on('click', function (e) {
                                                    //did not click a popover toggle or popover
                                                    if ($(e.target).data('toggle') !== 'popover'
                                                        && $(e.target).parents('.popover.in').length === 0) { 
                                                        $('[data-toggle="popover"]').popover('hide');
                                                    }
                                                });
                                                
                                            }
                                            
                                            /*>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>*/                  
                                            //confirmation dialog - must be here due to rerender  
                                            $("#prodDeleteConfirm").dialog({
                                                autoOpen: false,
                                                resizable: false,
                                                closeOnEscape: false,
                                                height:180,
                                                width:350,
                                                modal: true,
                                                title: "Please Confirm",
                                                classes: {
                                                    "ui-dialog-titlebar-close" : "dialogInvisible",
                                                    "ui-dialog-titlebar" : "dialogTitle"
                                                },
                                                open: function() {
                                                    console.log('dialog opened');
                                                    $('.ui-dialog-buttonpane').find('button:contains("Ok")').addClass('gbtn');
                                                    $('.ui-dialog-buttonpane').find('button:contains("Cancel")').addClass('gbtn');
                                                },
                                                buttons: [ {
                                                    text: "Ok",
                                                    classes:{"ui-button" : "highlight"},
                                                    click: function() {
                                                        $(this).dialog("close");
                                                        var productId = $(this).dialog("option","productId");
                                                        deleteProduct(productId);
                                                    }
                                                },
                                                          {
                                                              text: "Cancel", 
                                                              click: function() {
                                                                  $(this).dialog("close");
                                                              }
                                                          }]
                                            }); 
                                            
                                            /*>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>*/                  
                                            //Submit confirmation dialog - must be here due to rerender  
                                            $("#submitConfirm").dialog({
                                                autoOpen: false,
                                                resizable: false,
                                                closeOnEscape: false,
                                                height:180,
                                                width:350,
                                                modal: true,
                                                title: "Are you sure?",
                                                content: "Once you confirm, this form will lock and take you to the next form.",
                                                classes: {
                                                    "ui-dialog-titlebar-close" : "dialogInvisible",
                                                    "ui-dialog-titlebar" : "dialogTitle"
                                                },
                                                open: function() {
                                                    console.log('dialog opened');
                                                    $('.ui-dialog-buttonpane').find('button:contains("Confirm")').addClass('gbtn');
                                                    $('.ui-dialog-buttonpane').find('button:contains("Cancel")').addClass('gbtn');
                                                },
                                                buttons: [ {
                                                    text: "Confirm & Continue",
                                                    classes:{"ui-button" : "highlight"},
                                                    click: function() {
                                                        $(this).dialog("close");
                                                        // call submit form handler
                                                        checkRequiredFieldsAndDisplay();
                                                        //var productId = $(this).dialog("option","productId");
                                                        //deleteProduct(productId);
                                                    }
                                                },
                                                          {
                                                              text: "Cancel", 
                                                              click: function() {
                                                                  $(this).dialog("close");
                                                              }
                                                          }]
                                            }); 
                                            
                                            $("#reserviceInfoMessage").dialog({
                                                autoOpen: false,
                                                resizable: false,
                                                closeOnEscape: false,
                                                height:180,
                                                width:350,
                                                modal: true,
                                                title: "Redirect Notice?",
                                                classes: {
                                                    "ui-dialog-titlebar-close" : "dialogInvisible",
                                                    "ui-dialog-titlebar" : "dialogTitle"
                                                },
                                                open: function() {
                                                    console.log('dialog opened');
                                                    $('.ui-dialog-buttonpane').find('button:contains("Ok")').addClass('gbtn');
                                                },
                                                buttons: [ {
                                                    text: "Ok",
                                                    classes:{"ui-button" : "highlight"},
                                                    click: function() {
                                                        $(this).dialog("close");
                                                    }
                                                }]
                                            }); 
                                            
                                            /*>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>*/      
                                            var goBackToOpp = function()
                                            {
                                                //alert(typeof sforce);
                                                if(typeof sforce !== "undefined" && sforce !== null) {
                                                    // Salesforce1 navigation
                                                    sforce.one.navigateToURL("/{!eOppty.Id}", true);
                                                } else {
                                                    // Desktop navigation
                                                    window.open("/{!eOppty.Id}", '_self');
                                                }
                                            }
                                            
                                            /*>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>*/    
                                            
                                            togglePhysicalAddressVisibility("{!eOppty.Physical_Address_Same_As_Billing__c}");
                                            toggleNewAFEnrollDeductionFrequenciesVisibility("{!opportunity.Are_you_changing_AFenroll_Frequencies__c}");
                                            
                                            function reloadThePage2() {
                                                // Don't reload the page if there are any errors.
                                                if ({! HasErrorMessages == false }) {
                                                    reloadThePage();
                                                }
                                            }
                                            </script>    
                                            
                                            
                                        </apex:outputPanel>  <!-- end enrollmentTeamPanel -->
                                    </div>     <!------- end Enrollment Team Tab -------------------->
                                    
                                </div>     <!------- end Tab-Content (all tabs) -------->  
                                
                            </apex:outputPanel>   
                        </div>   <!-- end content -->
                        
                        <!-- Prev/Next Tab Buttons -->
                        <hr/>    
                        <div style="margin-top:15px;width:675px;margin-left:125px">
                            <a class="gbtn gbtnSecondary" href="#"   id="prevTabButton"  onclick="prevTab();" style="color:#FFF;width:66px">❮ Previous</a>
                            <a class="gbtn gbtnSecondary"   id="nextTabButton"  onclick="nextTab();" style="color:#FFF;width:66px;" href="#">Next ❯</a>
                            <a class="gbtn gbtnSecondary"   id="submitAndContinueButton" style="color:#FFF;" href="#"></a>
                        </div>
                        
                    </div>     <!--    end "container" -->
                    
                </apex:outputPanel>    <!--    end "page"      -->
                <script>
                
                $( ".helpButton" ).hover(
                    function() {
                        $(this).addClass("helpButtonOn");
                        $(this).removeClass("helpButton");
                        $(this).children('span.spanText').css("display", "inline");
                    }, function() {
                        $(this).removeClass("helpButtonOn");
                        $(this).addClass("helpButton");
                        $(this).children('span.spanText').css("display", "none");
                    }
                );  
                
                $(document).ready(function() {      
                    
                    // get rid of unused tabs
                    
                    console.log('**** document ready');
                    $('#tabs > li').each(function(i, val) { 
                        var anchor = this.firstChild;
                        if ( !$(anchor).is(':visible')) 
                            $(val).remove();                     
                    });
                    
                    // set active tab  
                    $('#tabs > li:first-child').addClass('active');
                    
                    var submitAndContinueBtn = $("#submitAndContinueButton");
                    var confirmButtonGen = $("#confirmButtonGen");
                    
                    // hide previous button & submit and continue button
                    $("#prevTabButton").hide();
                    submitAndContinueBtn.hide();
                    
                    // Do the same click as the confirm button gen click
                    submitAndContinueBtn.click(function() {
                        $('#confirmButtonGen').click();
                    });
                    
                    submitAndContinueBtn.html(confirmButtonGen.val());
                    
                    if('{!clickProductsTab}' == '1')
                        marketedTabLink.click();
                    else
                        $('#tabs > li:first-child > a').click();
                        
                    toggleEmployeeOtherWaitingPeriod("{!opportunity.EE_Eligibility_Waiting_Period__c}");
                    toggleNewAFEnrollDeductionFrequenciesVisibility("{!opportunity.Are_you_changing_AFenroll_Frequencies__c}");
                    
                    if ({! confirmSuccessful }) {
                        onSuccessfulSubmission();
                    }
                    
                    checkSelectedEnrollmentPath();

                    if({! cameFromReservice }){
                        $('#reserviceInfoMessage').dialog('open');
                        cameFromReservice = false;
                    }
                    
                    //$(".af-header").afStickIt();
                });
                
                function toggleEnrollmentRushWarningMessage() {
                    if (!enrollmentStartDateChanged) {
                        return;
                    }

                    $('#enrollmentRushWarningMsgContainer').hide();

                    var afesWarningDaysThreshold = {! $Label.AFES_Rush_Threshold_In_Days };
                    var awdWarningDaysThreshold = {! $Label.AWD_Rush_Threshold_In_Days };
                    var threshold = {! eOppty.RecordType.Name == 'AFES Enrollment' } ? afesWarningDaysThreshold : awdWarningDaysThreshold;

                    var enrollmentStartDateInput = document.getElementById('{! $Component.enrollmentStartDate }');

                    if (!enrollmentStartDateInput) {
                        return;
                    }

                    var enrollmentStartDateString = enrollmentStartDateInput.value;

                    if (!enrollmentStartDateString) {
                        return;
                    }

                    var enrollmentStartDate = Date.parse(enrollmentStartDateString);
                    var todaysDate = new Date();
                    todaysDate.setHours(0,0,0,0);

                    var enrollmentThresholdDate = new Date(enrollmentStartDate);
                    enrollmentThresholdDate.setDate(enrollmentThresholdDate.getDate() - threshold);

                    if (todaysDate <= enrollmentStartDate &&
                        todaysDate >= enrollmentThresholdDate) {

                        $('#enrollmentRushWarningMsgContainer').show();
                    }
                }
                
                function allowTaxIdCharacters(e) {
                    var AllowableCharacters = '1234567890-';
                    var k = document.all?parseInt(e.keyCode): parseInt(e.which);

                    if (k!=13 && k!=8 && k!=0){
                        if ((e.ctrlKey==false) && (e.altKey==false)) {
                            return (AllowableCharacters.indexOf(String.fromCharCode(k))!=-1);
                        } else {
                            return true;
                        }
                    } else {
                        return true;
                    }
                }
                
                function toggleEmployeeOtherWaitingPeriod(employeeEligibilityWaitingPeriod) {
                    $('.otherEligibilityWaitingPeriod').hide();
                
                    if (employeeEligibilityWaitingPeriod == 'Other') {
                        $('.otherEligibilityWaitingPeriod').show();
                    }
                }
                
                function toggleNewAFEnrollDeductionFrequenciesVisibility(changingAFEnrollFrequencies) {
                    $('.newAFEnrollDeductionFreq').hide();

                    if (changingAFEnrollFrequencies &&
                        changingAFEnrollFrequencies == 'Yes') {
                        $('.newAFEnrollDeductionFreq').show();
                    }
                }
                
                function onSuccessfulSubmission() {
                    var successMsg = 'The general information was confirmed. ';
                    showSuccessMessageAndContinueToNextUnsubmittedForm(successMsg);
                }
                
                function changeEnrollmentPath(enrollmentPathCheckbox) {
                    var enrollmentPathId = enrollmentPathCheckbox.getAttribute('enrollment-path');
                    var enrollmentPathToUse = enrollmentPathId;
                
                    if (enrollmentPathCheckbox.checked == false) {
                        enrollmentPathToUse = '';
                        
                        removeUnSelectFromAllEnrollmentPaths();
                    }
                    else {
                        unselectOtherEnrollmentPaths(enrollmentPathId);
                    }
                    
                    $('#enrollmentPathContainer' + enrollmentPathId).removeClass('af-enrollmentPathNotSelected');
                
                    updateTheEnrollmentPath(enrollmentPathToUse);
                }
                
                function unselectOtherEnrollmentPaths(enrollmentPathId) {
                    uncheckTheOtherEnrollmentPathCheckboxes(enrollmentPathId);

                    var otherEnrollmentPathContainers = $('div[class*="af-enrollmentPathContainer"]:NOT([id="enrollmentPathContainer' + enrollmentPathId + '"])');
                    
                    otherEnrollmentPathContainers.addClass('af-enrollmentPathNotSelected');    
                }
                
                function uncheckTheOtherEnrollmentPathCheckboxes(enrollmentPathId) {
                    var otherEnrollmentPathCheckboxes = $('input[class*="af-enrollmentPathCheckbox"]:NOT([enrollment-path=' + enrollmentPathId + '])');
                    
                    otherEnrollmentPathCheckboxes.attr('checked', false);
                }
                
                function removeUnSelectFromAllEnrollmentPaths() {
                    $('div[class*="af-enrollmentPathContainer"]').removeClass('af-enrollmentPathNotSelected');
                }
                
                function checkSelectedEnrollmentPath() {
                    $('[enrollment-path-selected="true"]').attr('checked', true);
                }
                </script>
                
                <!---------------------------------------------------------------------------- Page Actions --------------------------------------------------- -->
                <!---------------------------------------------------------------------------- Page Actions --------------------------------------------------- -->
                <!---------------------------------------------------------------------------- Page Actions --------------------------------------------------- -->
                <!---------------------------------------------------------------------------- Page Actions --------------------------------------------------- -->
                <!---------------------------------------------------------------------------- Page Actions --------------------------------------------------- -->
                
                <apex:ActionFunction name="saveRecord2" action="{!save}" rerender="messages, tabPanel"  oncomplete="$(currentTab).click();"/>

                <apex:ActionFunction name="saveRecordandRerenderPlatform2" action="{!save}" rerender="messages, platformDetails, tabPanel"
                                     oncomplete="$('.requiredLabel').css('visibility' , 'visible'); $(currentTab).click(); checkSelectedEnrollmentPath();" />  
                
                <apex:ActionFunction name="updateAccountField2" action="{!updateAccountField}" rerender="messages, tabPanel"  oncomplete="$(currentTab).click();">
                    <apex:param name="accountId" assignTo="{!accountId}" value="" />
                    <apex:param name="name" assignTo="{!fieldName}" value="" />
                    <apex:param name="value" assignTo="{!fieldValue}" value="" />
                </apex:ActionFunction>   
                
                <apex:ActionFunction name="updateCustomerSetupForm" action="{!updateCustomerSetupForm}" rerender="messages, tabPanel, enrollmentTeamPanel"  oncomplete="$(currentTab).click();">
                    <apex:param name="name" assignTo="{!fieldName}" value="" />
                    <apex:param name="value" assignTo="{!fieldValue}" value="" />
                    <apex:param name="contactType" assignTo="{!contactType}" value="" />
                </apex:ActionFunction>
                
                
                <apex:ActionFunction name="updateSection125Form" action="{!updateSection125Form}" rerender="messages, tabPanel, enrollmentTeamPanel" oncomplete="$(currentTab).click();">
                    <apex:param name="name" assignTo="{!fieldName}" value="" />
                    <apex:param name="value" assignTo="{!fieldValue}" value="" />
                    <apex:param name="contactType" assignTo="{!contactType}" value="" />
                </apex:ActionFunction>
                
                
                <apex:ActionFunction name="updatePlatformSetup2" action="{!updatePlatformSetup}" rerender="messages, tabPanel"
                                     oncomplete="$('.requiredLabel').css('visibility' , 'visible'); $(currentTab).click();" >
                    <apex:param name="name" assignTo="{!fieldName}" value="" />
                    <apex:param name="value" assignTo="{!fieldValue}" value="" />
                </apex:ActionFunction>
                
                <apex:ActionFunction name="updateProduct2" action="{!updateProduct}" rerender="messages, tabPanel" >
                    <apex:param name="prodid" assignTo="{!productId}" value=""/>
                    <apex:param name="name" assignTo="{!fieldName}" value="" />
                    <apex:param name="value" assignTo="{!fieldValue}" value="" />
                </apex:ActionFunction>
                
                <apex:ActionFunction name="updateProductAndReload" action="{!updateProduct}" rerender="messages, tabPanel"  status="sts" oncomplete="addProductCallback(false);">
                    <apex:param name="prodid" assignTo="{!productId}" value=""/>
                    <apex:param name="name" assignTo="{!fieldName}" value="" />
                    <apex:param name="value" assignTo="{!fieldValue}" value="" />
                </apex:ActionFunction>
                
                <apex:ActionFunction name="deleteProduct" action="{!deleteProduct}" rerender="messages" oncomplete="addProductCallback();"  status="sts">
                    <apex:param name="prodid" assignTo="{!productId}" value=""/>
                </apex:ActionFunction>
                
                <apex:ActionFunction name="updateEnrollmentOpportunity" action="{!updateEnrollmentOpportunity}" rerender="messages, tabPanel" />
                
                
                <apex:ActionFunction name="addSelectedProducts" action="{!addSelectedProducts}" rerender="messages, enrollmentTeamPanel" status="sts" oncomplete="addProductCallback({!addProductError});"/>
                
                <apex:actionstatus id="sts">
                    <apex:facet name="start">
                        <div class="waitingSearchDiv" id="el_loading" style="background-color: #fbfbfb; height:150%;opacity:0.65;width:100%;">
                            <div class="waitingHolder" style="top: 130px; width: 91px;">
                                <img class="waitingImage" src="/img/loading.gif" title="Please Wait..." />
                                <span class="waitingDescription">Please Wait...</span>
                            </div>
                        </div>
                    </apex:facet>
                </apex:actionstatus>  
                
                <!-- CONTACT related functions -->
                <apex:ActionFunction name="setContact"  action="{!setContact}" rerender="messages, tabPanel,enrollmentTeamPanel" oncomplete="$(currentTab).click();">
                    <apex:param name="name" assignTo="{!contactType}" value=""/>
                    <apex:param name="contactId" assignTo="{!contactId}" value=""/>
                </apex:ActionFunction>     
                
                
                <apex:ActionFunction name="updateContact"  action="{!updateContact}" rerender="messages, tabPanel, enrollmentTeamPanel" oncomplete="$(currentTab).click();">
                    <apex:param name="name" assignTo="{!fieldName}" value=""/>
                    <apex:param name="value" assignTo="{!fieldValue}" value="" />
                    <apex:param name="contactId" assignTo="{!contactId}" value=""/>
                    <apex:param name="contactType" assignTo="{!contactType}" value=""/>
                </apex:ActionFunction>     
                
                <apex:ActionFunction name="setContactToAdminContact"  action="{!setContactToAdminContact}" rerender="messages, tabPanel,enrollmentTeamPanel" oncomplete="$(currentTab).click();">
                    <apex:param name="name" assignTo="{!contactType}" value=""/>
                </apex:ActionFunction>  
                
                <apex:ActionFunction name="setBenefitContactToAdmin" action="{!updateCustomerSetupForm}" rerender="messages, tabPanel, enrollmentTeamPanel" 
                                     oncomplete="setContactToAdminContact('benefitContact');$(currentTab).click(); ">
                    <apex:param name="name" assignTo="{!fieldName}" value="" />
                    <apex:param name="value" assignTo="{!fieldValue}" value="" />
                    <apex:param name="contactType" assignTo="{!contactType}" value=""/>
                </apex:ActionFunction>  
                
                <apex:ActionFunction name="setBillingContactToAdmin" action="{!updateCustomerSetupForm}" rerender="messages, tabPanel,  enrollmentTeamPanel" 
                                     oncomplete="setContactToAdminContact('billingContact');$(currentTab).click();  ">
                    <apex:param name="name" assignTo="{!fieldName}" value="" />
                    <apex:param name="value" assignTo="{!fieldValue}" value="" />
                    <apex:param name="contactType" assignTo="{!contactType}" value=""/>
                </apex:ActionFunction>  
                
                <apex:ActionFunction name="setAnnuityContactToAdmin" action="{!updateCustomerSetupForm}" rerender="messages, tabPanel,  enrollmentTeamPanel" 
                                     oncomplete="setContactToAdminContact('annuityContact');$(currentTab).click();  ">
                    <apex:param name="name" assignTo="{!fieldName}" value="" />
                    <apex:param name="value" assignTo="{!fieldValue}" value="" />
                    <apex:param name="contactType" assignTo="{!contactType}" value=""/>
                </apex:ActionFunction>  
                
                <apex:ActionFunction name="setS125ContactToAdmin" action="{!updateSection125Form}" rerender="messages, tabPanel,  enrollmentTeamPanel" 
                                     oncomplete="setContactToAdminContact('s125Contact');$(currentTab).click();  ">
                    <apex:param name="name" assignTo="{!fieldName}" value="" />
                    <apex:param name="value" assignTo="{!fieldValue}" value="" />
                    <apex:param name="contactType" assignTo="{!contactType}" value=""/>
                </apex:ActionFunction>  
                
                <apex:ActionFunction name="setFlexContactToAdmin" action="{!updateSection125Form}" rerender="messages, tabPanel,  enrollmentTeamPanel" 
                                     oncomplete="setContactToAdminContact('flexContact');$(currentTab).click();  ">
                    <apex:param name="name" assignTo="{!fieldName}" value="" />
                    <apex:param name="value" assignTo="{!fieldValue}" value="" />
                    <apex:param name="contactType" assignTo="{!contactType}" value=""/>
                </apex:ActionFunction>
                
                <apex:ActionFunction name="setHSAContactToAdmin" action="{!updateSection125Form}" rerender="messages, tabPanel,  enrollmentTeamPanel" 
                                     oncomplete="setContactToAdminContact('hsaContact');$(currentTab).click();  ">
                    <apex:param name="name" assignTo="{!fieldName}" value="" />
                    <apex:param name="value" assignTo="{!fieldValue}" value="" />
                    <apex:param name="contactType" assignTo="{!contactType}" value=""/>
                </apex:ActionFunction>
                
                <apex:ActionFunction name="createNewContact" action="{!createNewContact}" rerender="messages, tabPanel,  enrollmentTeamPanel" oncomplete="$(currentTab).click();" >
                    <apex:param name="contactType" assignTo="{!contactType}" value="" />
                    <apex:param name="firstName" assignTo="{!newContactFirstName}" value="" />
                    <apex:param name="lastName" assignTo="{!newContactLastName}" value="" />
                    <apex:param name="title" assignTo="{!newContactTitle}" value="" />
                    <apex:param name="email" assignTo="{!newContactEmail}" value="" />
                    <apex:param name="phone" assignTo="{!newContactPhone}" value="" />
                    <apex:param name="ext" assignTo="{!newContactExt}" value="" />
                </apex:ActionFunction>  
                
                <apex:actionFunction name="insertOTM" action="{!insertOTM}"  rerender="oppTeamPanel">
                    <apex:param name="AccountID" value="" assignTo="{!managerId}"/>
                </apex:actionFunction>
                
                <apex:ActionFunction action="{!deleteOTM}" name="deleteOppTeamMember" rerender="oppTeamPanel"  >
                    <apex:param name="value" assignTo="{!otmId}" value="" />
                </apex:ActionFunction>  
                
                <apex:ActionFunction name="checkRequiredFieldsAndDisplay"  action="{!checkRequiredFieldsAndDisplay}" oncomplete="submitForm();" rerender="allTabs, tabPanel"  status="sts"/>
                <apex:ActionFunction name="submitFormCTRL" action="{!submitForm}" status="sts"/>
                <apex:actionFunction name="refreshOppTeamPanel"  action="{!doNothing}" rerender="page" oncomplete=" $('#enrollmentTeamTabLink').click();"/>
                
                <apex:actionFunction name="createEnrollmentEvent2"  action="{!createEnrollmentEvent}" rerender="messages">  
                    <apex:Param name="start" assignTo="{!enrollmentStart}" value="" />
                    <apex:Param name="end" assignTo="{!enrollmentEnd}" value="" />
                    <apex:Param name="navigate" assignTo="{!navToEnrollment}" value="" />
                </apex:actionFunction>
                
                <apex:ActionFunction name="updateEnrollmentForm" action="{!updateEnrollmentForm}" rerender="page, statusPanel" status="sts" oncomplete="reloadThePage();">
                    <apex:param name="name" assignTo="{!fieldName}" value="" />
                    <apex:param name="value" assignTo="{!fieldValue}" value="" />
                </apex:ActionFunction>
                
                <apex:ActionFunction name="updateTheEnrollmentPath" action="{! updateEnrollmentPath }" rerender="messages, tabPanel, platformDetails" oncomplete="$(currentTab).click(); checkSelectedEnrollmentPath();">
                    <apex:param name="enrollmentPathId" assignTo="{! selectedEnrollmentPathId }" value="" />
                </apex:ActionFunction>
                
                <apex:ActionFunction name="updatePlatformSetupForEnrollmentPath" action="{! updatePlatformSetupForEnrollmentPath }" rerender="messages, tabPanel" oncomplete="$(currentTab).click();" />
                
                <apex:ActionFunction name="reloadThePage" action="{!reloadPage}" />
                
                <apex:ActionFunction name="createUnlockRequest" action="{! createUnlockRequest }" rerender="page, statusPanel" status="sts" oncomplete="reloadThePage2();">
                    <apex:param name="unlockReason" assignTo="{! UnlockReason }" value="" />
                </apex:ActionFunction>
                
                <apex:ActionFunction name="lockSetupForms" action="{! completeUnlockRequest }" rerender="page, statusPanel" status="sts" oncomplete="reloadThePage2();" />
            </apex:form>
        </apex:pageBlock>
        
        
    </body>
    
</apex:page>